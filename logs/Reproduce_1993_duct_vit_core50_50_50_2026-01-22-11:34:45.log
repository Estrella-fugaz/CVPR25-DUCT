2026-01-22 11:34:45,397 [trainer.py] => config: configs/Template_core50_duct.json
2026-01-22 11:34:45,397 [trainer.py] => prefix: Reproduce
2026-01-22 11:34:45,397 [trainer.py] => dataset: core50
2026-01-22 11:34:45,397 [trainer.py] => data_path: /root/autodl-tmp/DATASETS/core50/core50_128x128
2026-01-22 11:34:45,397 [trainer.py] => device: [device(type='cuda', index=0)]
2026-01-22 11:34:45,397 [trainer.py] => task_name: [2, 3, 4, 5, 6, 7, 0, 1]
2026-01-22 11:34:45,397 [trainer.py] => total_sessions: 8
2026-01-22 11:34:45,397 [trainer.py] => fixed_memory: True
2026-01-22 11:34:45,397 [trainer.py] => memory_size: 0
2026-01-22 11:34:45,397 [trainer.py] => memory_per_class: 0
2026-01-22 11:34:45,397 [trainer.py] => shuffle: False
2026-01-22 11:34:45,397 [trainer.py] => init_cls: 50
2026-01-22 11:34:45,397 [trainer.py] => increment: 50
2026-01-22 11:34:45,397 [trainer.py] => model_name: duct
2026-01-22 11:34:45,397 [trainer.py] => net_type: vit
2026-01-22 11:34:45,397 [trainer.py] => seed: 1993
2026-01-22 11:34:45,397 [trainer.py] => EPSILON: 1e-08
2026-01-22 11:34:45,397 [trainer.py] => embd_dim: 768
2026-01-22 11:34:45,398 [trainer.py] => merge_scalar: 0.25
2026-01-22 11:34:45,398 [trainer.py] => head_merge_ratio: 0.25
2026-01-22 11:34:45,398 [trainer.py] => lr_re: 0.001
2026-01-22 11:34:45,398 [trainer.py] => epc_re: 5
2026-01-22 11:34:45,398 [trainer.py] => bcb_lr_scale: 0.001
2026-01-22 11:34:45,398 [trainer.py] => epochs: 10
2026-01-22 11:34:45,398 [trainer.py] => lrate: 0.1
2026-01-22 11:34:45,398 [trainer.py] => milestones: [60, 100, 140]
2026-01-22 11:34:45,398 [trainer.py] => lrate_decay: 0.1
2026-01-22 11:34:45,398 [trainer.py] => weight_decay: 0.0005
2026-01-22 11:34:45,398 [trainer.py] => ot_reg: 0.2
2026-01-22 11:34:45,398 [trainer.py] => batch_size: 128
2026-01-22 11:34:45,398 [trainer.py] => num_workers: 16
2026-01-22 11:34:45,398 [trainer.py] => logfilename: logs/Reproduce_1993_duct_vit_core50_50_50_2026-01-22-11:34:45
2026-01-22 11:34:45,398 [data.py] => Training sequence of domains: ['s2', 's9', 's1', 's6', 's5', 's8', 's11', 's4']
2026-01-22 11:40:01,317 [data_manager.py] => class order: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399]
2026-01-22 11:40:54,728 [vit_inc.py] => You are now using `vit_base_patch16_224` as backbone.
2026-01-22 11:40:58,999 [_builder.py] => Loading pretrained weights from url (https://storage.googleapis.com/vit_models/augreg/B_16-i21k-300ep-lr_0.001-aug_medium1-wd_0.1-do_0.0-sd_0.0--imagenet2012-steps_20k-lr_0.01-res_224.npz)
2026-01-22 11:41:03,913 [trainer.py] => All params: 91326184
2026-01-22 11:41:03,914 [trainer.py] => Trainable params: 91326184
2026-01-22 11:41:03,914 [duct.py] => Learning on 0-50
2026-01-22 11:45:16,392 [duct.py] => Initial epochs: 10
2026-01-22 11:46:33,810 [duct.py] => Task 0, Epoch 1/10 => Loss 1.807
2026-01-22 11:47:51,403 [duct.py] => Task 0, Epoch 2/10 => Loss 0.398
2026-01-22 11:49:09,099 [duct.py] => Task 0, Epoch 3/10 => Loss 0.316
2026-01-22 11:50:26,185 [duct.py] => Task 0, Epoch 4/10 => Loss 0.290
2026-01-22 11:52:26,020 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 11:53:56,191 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 11:53:56,193 [duct.py] => Task 0, Epoch 5/10 => Loss 0.262, Train_accy 94.250, Test_accy 87.840
2026-01-22 11:55:14,978 [duct.py] => Task 0, Epoch 6/10 => Loss 0.256
2026-01-22 11:56:32,282 [duct.py] => Task 0, Epoch 7/10 => Loss 0.243
2026-01-22 11:57:49,094 [duct.py] => Task 0, Epoch 8/10 => Loss 0.241
2026-01-22 11:59:06,618 [duct.py] => Task 0, Epoch 9/10 => Loss 0.231
2026-01-22 12:01:07,202 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 12:02:38,298 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 12:02:38,299 [duct.py] => Task 0, Epoch 10/10 => Loss 0.209, Train_accy 95.360, Test_accy 87.740
2026-01-22 12:19:19,478 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 12:19:19,482 [duct.py] => Test accuracy of model after backbone merge: 77.11
2026-01-22 12:20:37,285 [duct.py] => Task 0, Epoch 1/5 => Loss 0.456
2026-01-22 12:21:53,993 [duct.py] => Task 0, Epoch 2/5 => Loss 0.392
2026-01-22 12:23:13,289 [duct.py] => Task 0, Epoch 3/5 => Loss 0.377
2026-01-22 12:24:31,996 [duct.py] => Task 0, Epoch 4/5 => Loss 0.350
2026-01-22 12:26:29,504 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 12:27:59,390 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 12:27:59,391 [duct.py] => Task 0, Epoch 5/5 => Loss 0.357, Train_accy 92.480, Test_accy 82.310
2026-01-22 12:29:29,498 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 12:29:29,500 [duct.py] => Test accuracy of model after retraining: 82.31
2026-01-22 12:32:35,376 [trainer.py] => DUCT_VIT: {'total': 82.31, '00-49': 82.31, 'old': 0, 'new': 82.31}
2026-01-22 12:32:35,377 [trainer.py] => NME: {'total': 2.0, '00-49': 2.0, 'old': 0, 'new': 2.0}
2026-01-22 12:32:35,377 [trainer.py] => DUCT_VIT top1 curve: [82.31]
2026-01-22 12:32:35,377 [trainer.py] => NME top1 curve: [2.0]
2026-01-22 12:32:35,377 [trainer.py] => Average NME top1: 2.0
2026-01-22 12:32:35,378 [trainer.py] => Average top1: 82.31
2026-01-22 12:32:35,380 [trainer.py] => All params: 91364585
2026-01-22 12:32:35,382 [trainer.py] => Trainable params: 91364585
2026-01-22 12:32:35,382 [duct.py] => Learning on 50-100
2026-01-22 12:38:49,887 [duct.py] => Task 1, Epoch 1/10 => Loss 1.927
2026-01-22 12:40:08,342 [duct.py] => Task 1, Epoch 2/10 => Loss 0.456
2026-01-22 12:41:24,979 [duct.py] => Task 1, Epoch 3/10 => Loss 0.369
2026-01-22 12:42:43,277 [duct.py] => Task 1, Epoch 4/10 => Loss 0.340
2026-01-22 12:44:45,306 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 12:46:18,128 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 12:46:18,129 [duct.py] => Task 1, Epoch 5/10 => Loss 0.320, Train_accy 92.580, Test_accy 90.570
2026-01-22 12:47:37,514 [duct.py] => Task 1, Epoch 6/10 => Loss 0.283
2026-01-22 12:48:56,195 [duct.py] => Task 1, Epoch 7/10 => Loss 0.268
2026-01-22 12:50:15,085 [duct.py] => Task 1, Epoch 8/10 => Loss 0.264
2026-01-22 12:51:33,697 [duct.py] => Task 1, Epoch 9/10 => Loss 0.238
2026-01-22 12:53:33,597 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 12:55:03,923 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 12:55:03,924 [duct.py] => Task 1, Epoch 10/10 => Loss 0.240, Train_accy 93.780, Test_accy 90.890
2026-01-22 13:12:31,795 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 13:12:31,797 [duct.py] => Test accuracy of model after backbone merge: 88.62
2026-01-22 13:13:50,013 [duct.py] => Task 1, Epoch 1/5 => Loss 0.402
2026-01-22 13:15:07,616 [duct.py] => Task 1, Epoch 2/5 => Loss 0.364
2026-01-22 13:16:26,506 [duct.py] => Task 1, Epoch 3/5 => Loss 0.341
2026-01-22 13:17:45,087 [duct.py] => Task 1, Epoch 4/5 => Loss 0.347
2026-01-22 13:19:48,308 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 13:21:18,312 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 13:21:18,313 [duct.py] => Task 1, Epoch 5/5 => Loss 0.339, Train_accy 91.140, Test_accy 88.720
2026-01-22 13:22:50,805 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 13:22:50,806 [duct.py] => Test accuracy of model after retraining: 88.72
2026-01-22 13:24:25,681 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 13:24:25,682 [duct.py] => Test accuracy of model after classifier transport: 88.74
2026-01-22 13:27:36,893 [trainer.py] => DUCT_VIT: {'total': 88.74, '00-49': 88.74, 'old': 88.74, 'new': nan}
2026-01-22 13:27:36,893 [trainer.py] => NME: {'total': 2.0, '00-49': 2.0, 'old': 2.0, 'new': nan}
2026-01-22 13:27:36,893 [trainer.py] => DUCT_VIT top1 curve: [82.31, 88.74]
2026-01-22 13:27:36,893 [trainer.py] => NME top1 curve: [2.0, 2.0]
2026-01-22 13:27:36,894 [trainer.py] => Average NME top1: 2.0
2026-01-22 13:27:36,894 [trainer.py] => Average top1: 85.525
2026-01-22 13:27:36,895 [trainer.py] => All params: 91402985
2026-01-22 13:27:36,896 [trainer.py] => Trainable params: 91402985
2026-01-22 13:27:36,896 [duct.py] => Learning on 100-150
2026-01-22 13:33:59,805 [duct.py] => Task 2, Epoch 1/10 => Loss 1.673
2026-01-22 13:35:18,206 [duct.py] => Task 2, Epoch 2/10 => Loss 0.310
2026-01-22 13:36:37,392 [duct.py] => Task 2, Epoch 3/10 => Loss 0.250
2026-01-22 13:37:55,179 [duct.py] => Task 2, Epoch 4/10 => Loss 0.220
2026-01-22 13:39:57,103 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 13:41:29,992 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 13:41:29,993 [duct.py] => Task 2, Epoch 5/10 => Loss 0.209, Train_accy 94.980, Test_accy 92.090
2026-01-22 13:42:49,106 [duct.py] => Task 2, Epoch 6/10 => Loss 0.186
2026-01-22 13:44:08,077 [duct.py] => Task 2, Epoch 7/10 => Loss 0.185
2026-01-22 13:45:27,478 [duct.py] => Task 2, Epoch 8/10 => Loss 0.186
2026-01-22 13:46:44,826 [duct.py] => Task 2, Epoch 9/10 => Loss 0.174
2026-01-22 13:48:46,111 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 13:50:20,881 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 13:50:20,882 [duct.py] => Task 2, Epoch 10/10 => Loss 0.172, Train_accy 95.840, Test_accy 92.120
2026-01-22 14:07:44,600 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:07:44,601 [duct.py] => Test accuracy of model after backbone merge: 91.88
2026-01-22 14:09:03,483 [duct.py] => Task 2, Epoch 1/5 => Loss 0.203
2026-01-22 14:10:21,112 [duct.py] => Task 2, Epoch 2/5 => Loss 0.209
2026-01-22 14:11:39,324 [duct.py] => Task 2, Epoch 3/5 => Loss 0.199
2026-01-22 14:12:57,500 [duct.py] => Task 2, Epoch 4/5 => Loss 0.213
2026-01-22 14:14:56,706 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:16:27,390 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:16:27,391 [duct.py] => Task 2, Epoch 5/5 => Loss 0.183, Train_accy 94.970, Test_accy 91.750
2026-01-22 14:18:00,411 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:18:00,412 [duct.py] => Test accuracy of model after retraining: 91.75
2026-01-22 14:19:31,226 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:19:31,227 [duct.py] => Test accuracy of model after classifier transport: 91.75
2026-01-22 14:22:50,612 [trainer.py] => DUCT_VIT: {'total': 91.75, '00-49': 91.75, 'old': 91.75, 'new': nan}
2026-01-22 14:22:50,613 [trainer.py] => NME: {'total': 2.0, '00-49': 2.0, 'old': 2.0, 'new': nan}
2026-01-22 14:22:50,613 [trainer.py] => DUCT_VIT top1 curve: [82.31, 88.74, 91.75]
2026-01-22 14:22:50,613 [trainer.py] => NME top1 curve: [2.0, 2.0, 2.0]
2026-01-22 14:22:50,613 [trainer.py] => Average NME top1: 2.0
2026-01-22 14:22:50,613 [trainer.py] => Average top1: 87.60000000000001
2026-01-22 14:22:50,617 [trainer.py] => All params: 91441385
2026-01-22 14:22:50,619 [trainer.py] => Trainable params: 91441385
2026-01-22 14:22:50,619 [duct.py] => Learning on 150-200
2026-01-22 14:29:03,714 [duct.py] => Task 3, Epoch 1/10 => Loss 1.846
2026-01-22 14:30:20,487 [duct.py] => Task 3, Epoch 2/10 => Loss 0.355
2026-01-22 14:31:38,114 [duct.py] => Task 3, Epoch 3/10 => Loss 0.269
2026-01-22 14:32:55,111 [duct.py] => Task 3, Epoch 4/10 => Loss 0.223
2026-01-22 14:34:55,723 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:36:27,306 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:36:27,308 [duct.py] => Task 3, Epoch 5/10 => Loss 0.204, Train_accy 95.080, Test_accy 92.290
2026-01-22 14:37:43,365 [duct.py] => Task 3, Epoch 6/10 => Loss 0.193
2026-01-22 14:38:44,163 [duct.py] => Task 3, Epoch 7/10 => Loss 0.182
2026-01-22 14:39:44,807 [duct.py] => Task 3, Epoch 8/10 => Loss 0.172
2026-01-22 14:40:45,481 [duct.py] => Task 3, Epoch 9/10 => Loss 0.169
2026-01-22 14:42:14,309 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:43:24,535 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:43:24,536 [duct.py] => Task 3, Epoch 10/10 => Loss 0.146, Train_accy 95.900, Test_accy 92.250
2026-01-22 14:50:30,771 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:50:30,772 [duct.py] => Test accuracy of model after backbone merge: 93.22
2026-01-22 14:51:31,098 [duct.py] => Task 3, Epoch 1/5 => Loss 0.242
2026-01-22 14:52:31,479 [duct.py] => Task 3, Epoch 2/5 => Loss 0.227
2026-01-22 14:53:31,776 [duct.py] => Task 3, Epoch 3/5 => Loss 0.216
2026-01-22 14:54:32,282 [duct.py] => Task 3, Epoch 4/5 => Loss 0.215
2026-01-22 14:56:00,844 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:57:11,558 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:57:11,559 [duct.py] => Task 3, Epoch 5/5 => Loss 0.211, Train_accy 94.810, Test_accy 93.260
2026-01-22 14:58:22,262 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:58:22,262 [duct.py] => Test accuracy of model after retraining: 93.26
2026-01-22 14:59:33,160 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 14:59:33,161 [duct.py] => Test accuracy of model after classifier transport: 93.14
2026-01-22 15:01:58,539 [trainer.py] => DUCT_VIT: {'total': 93.14, '00-49': 93.14, 'old': 93.14, 'new': nan}
2026-01-22 15:01:58,539 [trainer.py] => NME: {'total': 2.0, '00-49': 2.0, 'old': 2.0, 'new': nan}
2026-01-22 15:01:58,539 [trainer.py] => DUCT_VIT top1 curve: [82.31, 88.74, 91.75, 93.14]
2026-01-22 15:01:58,539 [trainer.py] => NME top1 curve: [2.0, 2.0, 2.0, 2.0]
2026-01-22 15:01:58,539 [trainer.py] => Average NME top1: 2.0
2026-01-22 15:01:58,539 [trainer.py] => Average top1: 88.985
2026-01-22 15:01:58,540 [trainer.py] => All params: 91479785
2026-01-22 15:01:58,541 [trainer.py] => Trainable params: 91479785
2026-01-22 15:01:58,541 [duct.py] => Learning on 200-250
2026-01-22 15:05:15,619 [duct.py] => Task 4, Epoch 1/10 => Loss 1.734
2026-01-22 15:06:15,583 [duct.py] => Task 4, Epoch 2/10 => Loss 0.341
2026-01-22 15:07:15,408 [duct.py] => Task 4, Epoch 3/10 => Loss 0.267
2026-01-22 15:08:15,802 [duct.py] => Task 4, Epoch 4/10 => Loss 0.217
2026-01-22 15:09:42,950 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:10:51,698 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:10:51,698 [duct.py] => Task 4, Epoch 5/10 => Loss 0.202, Train_accy 94.830, Test_accy 91.630
2026-01-22 15:11:51,434 [duct.py] => Task 4, Epoch 6/10 => Loss 0.191
2026-01-22 15:12:51,202 [duct.py] => Task 4, Epoch 7/10 => Loss 0.182
2026-01-22 15:13:51,014 [duct.py] => Task 4, Epoch 8/10 => Loss 0.176
2026-01-22 15:14:50,925 [duct.py] => Task 4, Epoch 9/10 => Loss 0.159
2026-01-22 15:16:17,390 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:17:26,282 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:17:26,284 [duct.py] => Task 4, Epoch 10/10 => Loss 0.164, Train_accy 95.940, Test_accy 91.570
2026-01-22 15:23:59,113 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:23:59,114 [duct.py] => Test accuracy of model after backbone merge: 93.36
2026-01-22 15:24:58,960 [duct.py] => Task 4, Epoch 1/5 => Loss 0.209
2026-01-22 15:25:58,535 [duct.py] => Task 4, Epoch 2/5 => Loss 0.193
2026-01-22 15:26:58,223 [duct.py] => Task 4, Epoch 3/5 => Loss 0.196
2026-01-22 15:27:57,894 [duct.py] => Task 4, Epoch 4/5 => Loss 0.198
2026-01-22 15:29:24,861 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:30:35,660 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:30:35,661 [duct.py] => Task 4, Epoch 5/5 => Loss 0.194, Train_accy 95.170, Test_accy 93.590
2026-01-22 15:31:48,033 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:31:48,034 [duct.py] => Test accuracy of model after retraining: 93.59
2026-01-22 15:33:02,978 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:33:02,979 [duct.py] => Test accuracy of model after classifier transport: 93.12
2026-01-22 15:35:38,121 [trainer.py] => DUCT_VIT: {'total': 93.12, '00-49': 93.12, 'old': 93.12, 'new': nan}
2026-01-22 15:35:38,121 [trainer.py] => NME: {'total': 3.46, '00-49': 3.46, 'old': 3.46, 'new': nan}
2026-01-22 15:35:38,121 [trainer.py] => DUCT_VIT top1 curve: [82.31, 88.74, 91.75, 93.14, 93.12]
2026-01-22 15:35:38,122 [trainer.py] => NME top1 curve: [2.0, 2.0, 2.0, 2.0, 3.46]
2026-01-22 15:35:38,122 [trainer.py] => Average NME top1: 2.2920000000000003
2026-01-22 15:35:38,122 [trainer.py] => Average top1: 89.812
2026-01-22 15:35:38,122 [trainer.py] => All params: 91518185
2026-01-22 15:35:38,123 [trainer.py] => Trainable params: 91518185
2026-01-22 15:35:38,123 [duct.py] => Learning on 250-300
2026-01-22 15:39:32,118 [duct.py] => Task 5, Epoch 1/10 => Loss 1.760
2026-01-22 15:40:35,391 [duct.py] => Task 5, Epoch 2/10 => Loss 0.348
2026-01-22 15:41:39,242 [duct.py] => Task 5, Epoch 3/10 => Loss 0.265
2026-01-22 15:42:42,596 [duct.py] => Task 5, Epoch 4/10 => Loss 0.237
2026-01-22 15:44:17,263 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:45:30,809 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:45:30,810 [duct.py] => Task 5, Epoch 5/10 => Loss 0.219, Train_accy 94.990, Test_accy 93.420
2026-01-22 15:46:34,581 [duct.py] => Task 5, Epoch 6/10 => Loss 0.201
2026-01-22 15:47:38,592 [duct.py] => Task 5, Epoch 7/10 => Loss 0.191
2026-01-22 15:48:42,676 [duct.py] => Task 5, Epoch 8/10 => Loss 0.179
2026-01-22 15:49:46,764 [duct.py] => Task 5, Epoch 9/10 => Loss 0.167
2026-01-22 15:51:21,718 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:52:35,441 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 15:52:35,443 [duct.py] => Task 5, Epoch 10/10 => Loss 0.164, Train_accy 96.050, Test_accy 93.210
2026-01-22 16:02:00,088 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:02:00,089 [duct.py] => Test accuracy of model after backbone merge: 93.55
2026-01-22 16:03:03,763 [duct.py] => Task 5, Epoch 1/5 => Loss 0.222
2026-01-22 16:04:07,246 [duct.py] => Task 5, Epoch 2/5 => Loss 0.198
2026-01-22 16:05:10,808 [duct.py] => Task 5, Epoch 3/5 => Loss 0.194
2026-01-22 16:06:14,479 [duct.py] => Task 5, Epoch 4/5 => Loss 0.182
2026-01-22 16:07:49,938 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:09:06,197 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:09:06,199 [duct.py] => Task 5, Epoch 5/5 => Loss 0.182, Train_accy 94.860, Test_accy 93.990
2026-01-22 16:10:21,724 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:10:21,726 [duct.py] => Test accuracy of model after retraining: 93.99
2026-01-22 16:11:40,095 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:11:40,096 [duct.py] => Test accuracy of model after classifier transport: 93.48
2026-01-22 16:14:20,359 [trainer.py] => DUCT_VIT: {'total': 93.48, '00-49': 93.48, 'old': 93.48, 'new': nan}
2026-01-22 16:14:20,359 [trainer.py] => NME: {'total': 2.61, '00-49': 2.61, 'old': 2.61, 'new': nan}
2026-01-22 16:14:20,359 [trainer.py] => DUCT_VIT top1 curve: [82.31, 88.74, 91.75, 93.14, 93.12, 93.48]
2026-01-22 16:14:20,359 [trainer.py] => NME top1 curve: [2.0, 2.0, 2.0, 2.0, 3.46, 2.61]
2026-01-22 16:14:20,359 [trainer.py] => Average NME top1: 2.345
2026-01-22 16:14:20,359 [trainer.py] => Average top1: 90.42333333333333
2026-01-22 16:14:20,360 [trainer.py] => All params: 91556585
2026-01-22 16:14:20,360 [trainer.py] => Trainable params: 91556585
2026-01-22 16:14:20,360 [duct.py] => Learning on 300-350
2026-01-22 16:18:21,040 [duct.py] => Task 6, Epoch 1/10 => Loss 1.725
2026-01-22 16:19:24,940 [duct.py] => Task 6, Epoch 2/10 => Loss 0.303
2026-01-22 16:20:28,698 [duct.py] => Task 6, Epoch 3/10 => Loss 0.237
2026-01-22 16:21:32,712 [duct.py] => Task 6, Epoch 4/10 => Loss 0.200
2026-01-22 16:23:07,931 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:24:21,612 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:24:21,613 [duct.py] => Task 6, Epoch 5/10 => Loss 0.179, Train_accy 95.680, Test_accy 92.670
2026-01-22 16:25:25,444 [duct.py] => Task 6, Epoch 6/10 => Loss 0.175
2026-01-22 16:26:29,385 [duct.py] => Task 6, Epoch 7/10 => Loss 0.164
2026-01-22 16:27:33,207 [duct.py] => Task 6, Epoch 8/10 => Loss 0.152
2026-01-22 16:28:37,199 [duct.py] => Task 6, Epoch 9/10 => Loss 0.143
2026-01-22 16:30:12,302 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:31:25,815 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:31:25,816 [duct.py] => Task 6, Epoch 10/10 => Loss 0.136, Train_accy 96.400, Test_accy 93.050
2026-01-22 16:41:08,530 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:41:08,532 [duct.py] => Test accuracy of model after backbone merge: 93.17
2026-01-22 16:42:12,108 [duct.py] => Task 6, Epoch 1/5 => Loss 0.216
2026-01-22 16:43:15,843 [duct.py] => Task 6, Epoch 2/5 => Loss 0.181
2026-01-22 16:44:19,103 [duct.py] => Task 6, Epoch 3/5 => Loss 0.179
2026-01-22 16:45:22,924 [duct.py] => Task 6, Epoch 4/5 => Loss 0.168
2026-01-22 16:46:57,418 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:48:09,918 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:48:09,919 [duct.py] => Task 6, Epoch 5/5 => Loss 0.173, Train_accy 95.680, Test_accy 93.150
2026-01-22 16:49:22,474 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:49:22,474 [duct.py] => Test accuracy of model after retraining: 93.15
2026-01-22 16:50:35,776 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 16:50:35,777 [duct.py] => Test accuracy of model after classifier transport: 94.73
2026-01-22 16:53:10,569 [trainer.py] => DUCT_VIT: {'total': 94.73, '00-49': 94.73, 'old': 94.73, 'new': nan}
2026-01-22 16:53:10,569 [trainer.py] => NME: {'total': 2.02, '00-49': 2.02, 'old': 2.02, 'new': nan}
2026-01-22 16:53:10,569 [trainer.py] => DUCT_VIT top1 curve: [82.31, 88.74, 91.75, 93.14, 93.12, 93.48, 94.73]
2026-01-22 16:53:10,569 [trainer.py] => NME top1 curve: [2.0, 2.0, 2.0, 2.0, 3.46, 2.61, 2.02]
2026-01-22 16:53:10,569 [trainer.py] => Average NME top1: 2.2985714285714285
2026-01-22 16:53:10,569 [trainer.py] => Average top1: 91.03857142857143
2026-01-22 16:53:10,570 [trainer.py] => All params: 91594985
2026-01-22 16:53:10,570 [trainer.py] => Trainable params: 91594985
2026-01-22 16:53:10,570 [duct.py] => Learning on 350-400
2026-01-22 16:57:11,314 [duct.py] => Task 7, Epoch 1/10 => Loss 1.704
2026-01-22 16:58:14,587 [duct.py] => Task 7, Epoch 2/10 => Loss 0.308
2026-01-22 16:59:18,239 [duct.py] => Task 7, Epoch 3/10 => Loss 0.244
2026-01-22 17:00:21,416 [duct.py] => Task 7, Epoch 4/10 => Loss 0.202
2026-01-22 17:01:55,070 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 17:03:07,605 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 17:03:07,606 [duct.py] => Task 7, Epoch 5/10 => Loss 0.191, Train_accy 95.430, Test_accy 93.820
2026-01-22 17:04:10,997 [duct.py] => Task 7, Epoch 6/10 => Loss 0.178
2026-01-22 17:05:14,190 [duct.py] => Task 7, Epoch 7/10 => Loss 0.170
2026-01-22 17:06:17,606 [duct.py] => Task 7, Epoch 8/10 => Loss 0.152
2026-01-22 17:07:21,009 [duct.py] => Task 7, Epoch 9/10 => Loss 0.150
2026-01-22 17:08:54,639 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 17:10:07,764 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 17:10:07,765 [duct.py] => Task 7, Epoch 10/10 => Loss 0.151, Train_accy 96.330, Test_accy 94.000
2026-01-22 17:19:25,677 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 17:19:25,677 [duct.py] => Test accuracy of model after backbone merge: 93.95
2026-01-22 17:20:28,612 [duct.py] => Task 7, Epoch 1/5 => Loss 0.271
2026-01-22 17:21:31,601 [duct.py] => Task 7, Epoch 2/5 => Loss 0.212
2026-01-22 17:22:34,603 [duct.py] => Task 7, Epoch 3/5 => Loss 0.202
2026-01-22 17:23:37,563 [duct.py] => Task 7, Epoch 4/5 => Loss 0.209
2026-01-22 17:25:11,820 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 17:26:25,476 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 17:26:25,476 [duct.py] => Task 7, Epoch 5/5 => Loss 0.201, Train_accy 94.640, Test_accy 94.000
2026-01-22 17:27:38,795 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 17:27:38,796 [duct.py] => Test accuracy of model after retraining: 94.0
2026-01-22 17:28:53,441 [base.py] => Hint: You are using _compute_accuracy_domain().
2026-01-22 17:28:53,442 [duct.py] => Test accuracy of model after classifier transport: 94.35
2026-01-22 17:31:29,227 [trainer.py] => DUCT_VIT: {'total': 94.35, '00-49': 94.35, 'old': 94.35, 'new': nan}
2026-01-22 17:31:29,227 [trainer.py] => NME: {'total': 2.0, '00-49': 2.0, 'old': 2.0, 'new': nan}
2026-01-22 17:31:29,227 [trainer.py] => DUCT_VIT top1 curve: [82.31, 88.74, 91.75, 93.14, 93.12, 93.48, 94.73, 94.35]
2026-01-22 17:31:29,227 [trainer.py] => NME top1 curve: [2.0, 2.0, 2.0, 2.0, 3.46, 2.61, 2.02, 2.0]
2026-01-22 17:31:29,227 [trainer.py] => Average NME top1: 2.26125
2026-01-22 17:31:29,227 [trainer.py] => Average top1: 91.4525
2026-01-22 17:31:29,227 [trainer.py] => Accuracy Matrix:
2026-01-22 17:31:29,227 [trainer.py] => [82.31  0.    0.    0.    0.    0.    0.    0.  ]
2026-01-22 17:31:29,228 [trainer.py] => [88.74  0.    0.    0.    0.    0.    0.    0.  ]
2026-01-22 17:31:29,228 [trainer.py] => [91.75  0.    0.    0.    0.    0.    0.    0.  ]
2026-01-22 17:31:29,228 [trainer.py] => [93.14  0.    0.    0.    0.    0.    0.    0.  ]
2026-01-22 17:31:29,228 [trainer.py] => [93.12  0.    0.    0.    0.    0.    0.    0.  ]
2026-01-22 17:31:29,229 [trainer.py] => [93.48  0.    0.    0.    0.    0.    0.    0.  ]
2026-01-22 17:31:29,229 [trainer.py] => [94.73  0.    0.    0.    0.    0.    0.    0.  ]
2026-01-22 17:31:29,229 [trainer.py] => [94.35  0.    0.    0.    0.    0.    0.    0.  ]
2026-01-22 17:31:29,229 [trainer.py] => Forgetting (after last task): 0.054285714285715665
2026-01-22 17:31:29,229 [trainer.py] => NME Accuracy Matrix:
2026-01-22 17:31:29,229 [trainer.py] => [2. 0. 0. 0. 0. 0. 0. 0.]
2026-01-22 17:31:29,229 [trainer.py] => [2. 0. 0. 0. 0. 0. 0. 0.]
2026-01-22 17:31:29,229 [trainer.py] => [2. 0. 0. 0. 0. 0. 0. 0.]
2026-01-22 17:31:29,230 [trainer.py] => [2. 0. 0. 0. 0. 0. 0. 0.]
2026-01-22 17:31:29,230 [trainer.py] => [3.46 0.   0.   0.   0.   0.   0.   0.  ]
2026-01-22 17:31:29,230 [trainer.py] => [2.61 0.   0.   0.   0.   0.   0.   0.  ]
2026-01-22 17:31:29,230 [trainer.py] => [2.02 0.   0.   0.   0.   0.   0.   0.  ]
2026-01-22 17:31:29,230 [trainer.py] => [2. 0. 0. 0. 0. 0. 0. 0.]
2026-01-22 17:31:29,230 [trainer.py] => NME Forgetting (after last task): 0.20857142857142857
