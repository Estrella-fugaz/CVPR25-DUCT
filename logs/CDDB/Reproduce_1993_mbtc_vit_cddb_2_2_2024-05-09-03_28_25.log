2024-05-09 03:28:25,777 [trainer.py] => prefix: Reproduce
2024-05-09 03:28:25,777 [trainer.py] => dataset: cddb
2024-05-09 03:28:25,777 [trainer.py] => multiclass: [0, 0, 0, 0, 0]
2024-05-09 03:28:25,777 [trainer.py] => class_order: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2024-05-09 03:28:25,777 [trainer.py] => memory_size: 0
2024-05-09 03:28:25,777 [trainer.py] => memory_per_class: 0
2024-05-09 03:28:25,777 [trainer.py] => fixed_memory: True
2024-05-09 03:28:25,777 [trainer.py] => shuffle: False
2024-05-09 03:28:25,777 [trainer.py] => init_cls: 2
2024-05-09 03:28:25,777 [trainer.py] => increment: 2
2024-05-09 03:28:25,777 [trainer.py] => total_sessions: 5
2024-05-09 03:28:25,777 [trainer.py] => model_name: duct
2024-05-09 03:28:25,777 [trainer.py] => net_type: vit
2024-05-09 03:28:25,777 [trainer.py] => merge_scalar: 0.5
2024-05-09 03:28:25,777 [trainer.py] => head_merge_ratio: 0.5
2024-05-09 03:28:25,778 [trainer.py] => ot_reg: 0.1
2024-05-09 03:28:25,778 [trainer.py] => lr_re: 0.001
2024-05-09 03:28:25,778 [trainer.py] => epc_re: 5
2024-05-09 03:28:25,778 [trainer.py] => embd_dim: 768
2024-05-09 03:28:25,778 [trainer.py] => seed: 1993
2024-05-09 03:28:25,778 [trainer.py] => EPSILON: 1e-08
2024-05-09 03:28:25,778 [trainer.py] => bcb_lr_scale: 0.01
2024-05-09 03:28:25,778 [trainer.py] => epochs: 15
2024-05-09 03:28:25,778 [trainer.py] => lrate: 0.1
2024-05-09 03:28:25,778 [trainer.py] => milestones: [60, 100, 140]
2024-05-09 03:28:25,778 [trainer.py] => lrate_decay: 0.1
2024-05-09 03:28:25,778 [trainer.py] => weight_decay: 0.0005
2024-05-09 03:28:25,778 [trainer.py] => batch_size: 128
2024-05-09 03:28:25,778 [trainer.py] => num_workers: 16
2024-05-09 03:28:25,778 [trainer.py] => task_name: ['san', 'whichfaceisreal', 'biggan', 'wild', 'gaugan']
2024-05-09 03:28:25,778 [trainer.py] => logfilename: logs/Reproduce_1993_mbtc_vit_cddb_2_2_2024-05-09-03:28:25
2024-05-09 03:28:25,837 [data_manager.py] => class order: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2024-05-09 03:28:25,848 [vit_inc.py] => You are now using `vit_base_patch16_224` as backbone.
2024-05-09 03:28:27,131 [_builder.py] => Loading pretrained weights from url (https://storage.googleapis.com/vit_models/augreg/B_16-i21k-300ep-lr_0.001-aug_medium1-wd_0.1-do_0.0-sd_0.0--imagenet2012-steps_20k-lr_0.01-res_224.npz)
2024-05-09 03:28:29,656 [trainer.py] => All params: 91326184
2024-05-09 03:28:29,657 [trainer.py] => Trainable params: 91326184
2024-05-09 03:28:29,657 [mbtc.py] => Learning on 0-2
2024-05-09 03:28:39,168 [mbtc.py] => Initial epochs: 15Z
2024-05-09 03:28:49,236 [mbtc.py] => Task 0, Epoch 1/15 => Loss 0.697
2024-05-09 03:28:49,236 [mbtc.py] => {'Train loss': 0.6967724561691284}
2024-05-09 03:28:54,831 [mbtc.py] => Task 0, Epoch 2/15 => Loss 0.691
2024-05-09 03:28:54,831 [mbtc.py] => {'Train loss': 0.690680464108785}
2024-05-09 03:29:00,430 [mbtc.py] => Task 0, Epoch 3/15 => Loss 0.684
2024-05-09 03:29:00,431 [mbtc.py] => {'Train loss': 0.6836345394452413}
2024-05-09 03:29:06,150 [mbtc.py] => Task 0, Epoch 4/15 => Loss 0.679
2024-05-09 03:29:06,150 [mbtc.py] => {'Train loss': 0.6794376174608866}
2024-05-09 03:29:16,293 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:29:20,973 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:29:20,974 [mbtc.py] => {'Train acc': 69.23, 'Test acc': 45.56}
2024-05-09 03:29:20,974 [mbtc.py] => Task 0, Epoch 5/15 => Loss 0.682, Train_accy 69.230, Test_accy 45.560
2024-05-09 03:29:20,974 [mbtc.py] => {'Train loss': 0.6820178826649984}
2024-05-09 03:29:26,359 [mbtc.py] => Task 0, Epoch 6/15 => Loss 0.646
2024-05-09 03:29:26,359 [mbtc.py] => {'Train loss': 0.6464845935503641}
2024-05-09 03:29:31,932 [mbtc.py] => Task 0, Epoch 7/15 => Loss 0.625
2024-05-09 03:29:31,932 [mbtc.py] => {'Train loss': 0.6245085398356119}
2024-05-09 03:29:37,714 [mbtc.py] => Task 0, Epoch 8/15 => Loss 0.648
2024-05-09 03:29:37,714 [mbtc.py] => {'Train loss': 0.6480125784873962}
2024-05-09 03:29:43,213 [mbtc.py] => Task 0, Epoch 9/15 => Loss 0.585
2024-05-09 03:29:43,213 [mbtc.py] => {'Train loss': 0.5852900147438049}
2024-05-09 03:29:53,311 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:29:58,011 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:29:58,011 [mbtc.py] => {'Train acc': 75.0, 'Test acc': 47.78}
2024-05-09 03:29:58,012 [mbtc.py] => Task 0, Epoch 10/15 => Loss 0.519, Train_accy 75.000, Test_accy 47.780
2024-05-09 03:29:58,012 [mbtc.py] => {'Train loss': 0.5189268887042999}
2024-05-09 03:30:02,952 [mbtc.py] => Task 0, Epoch 11/15 => Loss 0.536
2024-05-09 03:30:02,952 [mbtc.py] => {'Train loss': 0.5363073746363322}
2024-05-09 03:30:08,554 [mbtc.py] => Task 0, Epoch 12/15 => Loss 0.415
2024-05-09 03:30:08,554 [mbtc.py] => {'Train loss': 0.41509101788202923}
2024-05-09 03:30:14,209 [mbtc.py] => Task 0, Epoch 13/15 => Loss 0.414
2024-05-09 03:30:14,209 [mbtc.py] => {'Train loss': 0.4139452278614044}
2024-05-09 03:30:19,789 [mbtc.py] => Task 0, Epoch 14/15 => Loss 0.397
2024-05-09 03:30:19,789 [mbtc.py] => {'Train loss': 0.3972444732983907}
2024-05-09 03:30:29,982 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:30:34,654 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:30:34,654 [mbtc.py] => {'Train acc': 91.92, 'Test acc': 70.0}
2024-05-09 03:30:34,655 [mbtc.py] => Task 0, Epoch 15/15 => Loss 0.296, Train_accy 91.920, Test_accy 70.000
2024-05-09 03:30:34,655 [mbtc.py] => {'Train loss': 0.29639644424120587}
2024-05-09 03:30:34,670 [mbtc.py] => Merge scalar: 0.5
2024-05-09 03:30:39,358 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:30:39,358 [mbtc.py] => Test accuracy of model after backbone merge: 57.78
2024-05-09 03:30:45,166 [mbtc.py] => Task 0, Epoch 1/5 => Loss 0.352
2024-05-09 03:30:45,167 [mbtc.py] => {'Train loss': 0.3522871931393941}
2024-05-09 03:30:50,799 [mbtc.py] => Task 0, Epoch 2/5 => Loss 0.394
2024-05-09 03:30:50,799 [mbtc.py] => {'Train loss': 0.39401277899742126}
2024-05-09 03:30:56,254 [mbtc.py] => Task 0, Epoch 3/5 => Loss 0.337
2024-05-09 03:30:56,254 [mbtc.py] => {'Train loss': 0.33666850129763287}
2024-05-09 03:31:01,887 [mbtc.py] => Task 0, Epoch 4/5 => Loss 0.393
2024-05-09 03:31:01,887 [mbtc.py] => {'Train loss': 0.39278167486190796}
2024-05-09 03:31:11,911 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:31:16,723 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:31:16,724 [mbtc.py] => {'Train acc': 89.23, 'Test acc': 54.44}
2024-05-09 03:31:16,724 [mbtc.py] => Task 0, Epoch 5/5 => Loss 0.433, Train_accy 89.230, Test_accy 54.440
2024-05-09 03:31:16,724 [mbtc.py] => {'Train loss': 0.43274502952893573}
2024-05-09 03:31:21,519 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:31:21,519 [mbtc.py] => Test accuracy of model after retraining: 54.44
2024-05-09 03:31:31,044 [trainer.py] => MBTC_VIT: {'total': 54.44, '00-01': 54.44, 'old': 0, 'new': 54.44}
2024-05-09 03:31:31,045 [trainer.py] => NME: {'total': 50.0, '00-01': 50.0, 'old': 0, 'new': 50.0}
2024-05-09 03:31:31,045 [trainer.py] => MBTC_VIT top1 curve: [54.44]
2024-05-09 03:31:31,045 [trainer.py] => NME top1 curve: [50.0]
2024-05-09 03:31:31,045 [trainer.py] => Average NME top1: 50.0
2024-05-09 03:31:31,045 [trainer.py] => Average top1: 54.44
2024-05-09 03:31:31,046 [trainer.py] => All params: 91327721
2024-05-09 03:31:31,046 [trainer.py] => Trainable params: 91327721
2024-05-09 03:31:31,046 [mbtc.py] => Learning on 2-4
2024-05-09 03:31:31,047 [vit_inc.py] => Initialize the new class nodes with the old class nodes of the previous task.
2024-05-09 03:32:07,043 [mbtc.py] => Task 1, Epoch 1/15 => Loss 0.703
2024-05-09 03:32:07,044 [mbtc.py] => {'Train loss': 0.7032532811164856}
2024-05-09 03:32:23,873 [mbtc.py] => Task 1, Epoch 2/15 => Loss 0.696
2024-05-09 03:32:23,874 [mbtc.py] => {'Train loss': 0.6957475006580353}
2024-05-09 03:32:40,990 [mbtc.py] => Task 1, Epoch 3/15 => Loss 0.693
2024-05-09 03:32:40,990 [mbtc.py] => {'Train loss': 0.6930690050125122}
2024-05-09 03:32:54,889 [mbtc.py] => Task 1, Epoch 4/15 => Loss 0.688
2024-05-09 03:32:54,889 [mbtc.py] => {'Train loss': 0.6877154469490051}
2024-05-09 03:33:22,856 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:33:31,700 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:33:31,700 [mbtc.py] => {'Train acc': 56.42, 'Test acc': 54.49}
2024-05-09 03:33:31,701 [mbtc.py] => Task 1, Epoch 5/15 => Loss 0.684, Train_accy 56.420, Test_accy 54.490
2024-05-09 03:33:31,701 [mbtc.py] => {'Train loss': 0.6835858881473541}
2024-05-09 03:33:48,484 [mbtc.py] => Task 1, Epoch 6/15 => Loss 0.673
2024-05-09 03:33:48,484 [mbtc.py] => {'Train loss': 0.6727663040161133}
2024-05-09 03:34:05,477 [mbtc.py] => Task 1, Epoch 7/15 => Loss 0.648
2024-05-09 03:34:05,478 [mbtc.py] => {'Train loss': 0.6477784872055053}
2024-05-09 03:34:20,139 [mbtc.py] => Task 1, Epoch 8/15 => Loss 0.608
2024-05-09 03:34:20,139 [mbtc.py] => {'Train loss': 0.6079107463359833}
2024-05-09 03:34:36,971 [mbtc.py] => Task 1, Epoch 9/15 => Loss 0.524
2024-05-09 03:34:36,972 [mbtc.py] => {'Train loss': 0.5238267660140992}
2024-05-09 03:35:05,254 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:35:14,045 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:35:14,045 [mbtc.py] => {'Train acc': 81.67, 'Test acc': 73.06}
2024-05-09 03:35:14,045 [mbtc.py] => Task 1, Epoch 10/15 => Loss 0.392, Train_accy 81.670, Test_accy 73.060
2024-05-09 03:35:14,045 [mbtc.py] => {'Train loss': 0.39180520474910735}
2024-05-09 03:35:31,345 [mbtc.py] => Task 1, Epoch 11/15 => Loss 0.314
2024-05-09 03:35:31,345 [mbtc.py] => {'Train loss': 0.31426247805356977}
2024-05-09 03:35:48,693 [mbtc.py] => Task 1, Epoch 12/15 => Loss 0.243
2024-05-09 03:35:48,693 [mbtc.py] => {'Train loss': 0.24337550848722458}
2024-05-09 03:36:05,885 [mbtc.py] => Task 1, Epoch 13/15 => Loss 0.214
2024-05-09 03:36:05,885 [mbtc.py] => {'Train loss': 0.2138907343149185}
2024-05-09 03:36:22,790 [mbtc.py] => Task 1, Epoch 14/15 => Loss 0.126
2024-05-09 03:36:22,791 [mbtc.py] => {'Train loss': 0.1258738197386265}
2024-05-09 03:36:50,784 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:36:59,563 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:36:59,563 [mbtc.py] => {'Train acc': 97.75, 'Test acc': 86.12}
2024-05-09 03:36:59,563 [mbtc.py] => Task 1, Epoch 15/15 => Loss 0.108, Train_accy 97.750, Test_accy 86.120
2024-05-09 03:36:59,563 [mbtc.py] => {'Train loss': 0.10827047899365425}
2024-05-09 03:36:59,577 [mbtc.py] => Merge scalar: 0.5
2024-05-09 03:37:08,663 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:37:08,664 [mbtc.py] => Test accuracy of model after backbone merge: 80.82
2024-05-09 03:37:22,563 [mbtc.py] => Task 1, Epoch 1/5 => Loss 0.312
2024-05-09 03:37:22,563 [mbtc.py] => {'Train loss': 0.3118823617696762}
2024-05-09 03:37:37,476 [mbtc.py] => Task 1, Epoch 2/5 => Loss 0.237
2024-05-09 03:37:37,477 [mbtc.py] => {'Train loss': 0.23737609386444092}
2024-05-09 03:37:52,596 [mbtc.py] => Task 1, Epoch 3/5 => Loss 0.231
2024-05-09 03:37:52,597 [mbtc.py] => {'Train loss': 0.23138311356306077}
2024-05-09 03:38:05,884 [mbtc.py] => Task 1, Epoch 4/5 => Loss 0.214
2024-05-09 03:38:05,885 [mbtc.py] => {'Train loss': 0.2138039141893387}
2024-05-09 03:38:31,619 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:38:40,599 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:38:40,600 [mbtc.py] => {'Train acc': 93.75, 'Test acc': 83.47}
2024-05-09 03:38:40,600 [mbtc.py] => Task 1, Epoch 5/5 => Loss 0.217, Train_accy 93.750, Test_accy 83.470
2024-05-09 03:38:40,600 [mbtc.py] => {'Train loss': 0.21675640046596528}
2024-05-09 03:38:49,540 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:38:49,540 [mbtc.py] => Test accuracy of model after retraining: 83.47
2024-05-09 03:38:51,681 [mbtc.py] => The OT cost: 60.68411
2024-05-09 03:38:51,681 [mbtc.py] => Head merge ratio: 0.5
2024-05-09 03:38:51,682 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-09 03:39:00,690 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:39:00,691 [mbtc.py] => Test accuracy of model after classifier transport: 82.86
2024-05-09 03:39:18,767 [trainer.py] => MBTC_VIT: {'total': 82.86, '00-01': 56.67, '02-03': 88.75, 'old': 56.67, 'new': 88.75}
2024-05-09 03:39:18,767 [trainer.py] => NME: {'total': 50.0, '00-01': 50.0, '02-03': 50.0, 'old': 50.0, 'new': 50.0}
2024-05-09 03:39:18,767 [trainer.py] => MBTC_VIT top1 curve: [54.44, 82.86]
2024-05-09 03:39:18,767 [trainer.py] => NME top1 curve: [50.0, 50.0]
2024-05-09 03:39:18,767 [trainer.py] => Average NME top1: 50.0
2024-05-09 03:39:18,767 [trainer.py] => Average top1: 68.65
2024-05-09 03:39:18,768 [trainer.py] => All params: 91329257
2024-05-09 03:39:18,769 [trainer.py] => Trainable params: 91329257
2024-05-09 03:39:18,769 [mbtc.py] => Learning on 4-6
2024-05-09 03:39:18,770 [vit_inc.py] => Initialize the new class nodes with the old class nodes of the previous task.
2024-05-09 03:39:49,232 [mbtc.py] => Task 2, Epoch 1/15 => Loss 0.691
2024-05-09 03:39:49,232 [mbtc.py] => {'Train loss': 0.6909266835764835}
2024-05-09 03:40:06,097 [mbtc.py] => Task 2, Epoch 2/15 => Loss 0.677
2024-05-09 03:40:06,098 [mbtc.py] => {'Train loss': 0.676908574606243}
2024-05-09 03:40:24,931 [mbtc.py] => Task 2, Epoch 3/15 => Loss 0.652
2024-05-09 03:40:24,931 [mbtc.py] => {'Train loss': 0.6518832821595041}
2024-05-09 03:40:43,480 [mbtc.py] => Task 2, Epoch 4/15 => Loss 0.608
2024-05-09 03:40:43,480 [mbtc.py] => {'Train loss': 0.6079423804032175}
2024-05-09 03:41:11,858 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:41:23,104 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:41:23,105 [mbtc.py] => {'Train acc': 83.67, 'Test acc': 68.68}
2024-05-09 03:41:23,105 [mbtc.py] => Task 2, Epoch 5/15 => Loss 0.523, Train_accy 83.670, Test_accy 68.680
2024-05-09 03:41:23,105 [mbtc.py] => {'Train loss': 0.5226992572608747}
2024-05-09 03:41:42,250 [mbtc.py] => Task 2, Epoch 6/15 => Loss 0.260
2024-05-09 03:41:42,250 [mbtc.py] => {'Train loss': 0.2604423392760126}
2024-05-09 03:42:01,122 [mbtc.py] => Task 2, Epoch 7/15 => Loss 0.135
2024-05-09 03:42:01,122 [mbtc.py] => {'Train loss': 0.13498273491859436}
2024-05-09 03:42:17,235 [mbtc.py] => Task 2, Epoch 8/15 => Loss 0.092
2024-05-09 03:42:17,236 [mbtc.py] => {'Train loss': 0.09230057757936026}
2024-05-09 03:42:38,093 [mbtc.py] => Task 2, Epoch 9/15 => Loss 0.047
2024-05-09 03:42:38,094 [mbtc.py] => {'Train loss': 0.047063993388100675}
2024-05-09 03:43:12,220 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:43:24,360 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:43:24,361 [mbtc.py] => {'Train acc': 98.58, 'Test acc': 81.55}
2024-05-09 03:43:24,361 [mbtc.py] => Task 2, Epoch 10/15 => Loss 0.077, Train_accy 98.580, Test_accy 81.550
2024-05-09 03:43:24,361 [mbtc.py] => {'Train loss': 0.0773318941263776}
2024-05-09 03:43:46,737 [mbtc.py] => Task 2, Epoch 11/15 => Loss 0.040
2024-05-09 03:43:46,737 [mbtc.py] => {'Train loss': 0.04027485357303368}
2024-05-09 03:44:08,771 [mbtc.py] => Task 2, Epoch 12/15 => Loss 0.036
2024-05-09 03:44:08,771 [mbtc.py] => {'Train loss': 0.0358390174806118}
2024-05-09 03:44:31,005 [mbtc.py] => Task 2, Epoch 13/15 => Loss 0.042
2024-05-09 03:44:31,005 [mbtc.py] => {'Train loss': 0.041604319366773494}
2024-05-09 03:44:53,063 [mbtc.py] => Task 2, Epoch 14/15 => Loss 0.026
2024-05-09 03:44:53,063 [mbtc.py] => {'Train loss': 0.02639993361050361}
2024-05-09 03:45:25,327 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:45:37,416 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:45:37,417 [mbtc.py] => {'Train acc': 99.38, 'Test acc': 84.03}
2024-05-09 03:45:37,417 [mbtc.py] => Task 2, Epoch 15/15 => Loss 0.023, Train_accy 99.380, Test_accy 84.030
2024-05-09 03:45:37,417 [mbtc.py] => {'Train loss': 0.02265974565556175}
2024-05-09 03:45:37,431 [mbtc.py] => Merge scalar: 0.5
2024-05-09 03:45:50,835 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:45:50,835 [mbtc.py] => Test accuracy of model after backbone merge: 86.05
2024-05-09 03:46:13,135 [mbtc.py] => Task 2, Epoch 1/5 => Loss 0.101
2024-05-09 03:46:13,136 [mbtc.py] => {'Train loss': 0.10134101266923703}
2024-05-09 03:46:35,238 [mbtc.py] => Task 2, Epoch 2/5 => Loss 0.081
2024-05-09 03:46:35,238 [mbtc.py] => {'Train loss': 0.08095130304756917}
2024-05-09 03:46:57,388 [mbtc.py] => Task 2, Epoch 3/5 => Loss 0.076
2024-05-09 03:46:57,389 [mbtc.py] => {'Train loss': 0.07568525581767685}
2024-05-09 03:47:19,683 [mbtc.py] => Task 2, Epoch 4/5 => Loss 0.069
2024-05-09 03:47:19,684 [mbtc.py] => {'Train loss': 0.06896350042600381}
2024-05-09 03:47:52,814 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:48:04,206 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:48:04,206 [mbtc.py] => {'Train acc': 96.92, 'Test acc': 89.3}
2024-05-09 03:48:04,206 [mbtc.py] => Task 2, Epoch 5/5 => Loss 0.074, Train_accy 96.920, Test_accy 89.300
2024-05-09 03:48:04,207 [mbtc.py] => {'Train loss': 0.07412330159231235}
2024-05-09 03:48:16,278 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:48:16,278 [mbtc.py] => Test accuracy of model after retraining: 89.3
2024-05-09 03:48:16,296 [mbtc.py] => The OT cost: 24.87404
2024-05-09 03:48:16,296 [mbtc.py] => Head merge ratio: 0.5
2024-05-09 03:48:16,297 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-09 03:48:16,524 [mbtc.py] => The OT cost: 54.95665
2024-05-09 03:48:16,524 [mbtc.py] => Head merge ratio: 0.5
2024-05-09 03:48:16,526 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-09 03:48:30,237 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:48:30,238 [mbtc.py] => Test accuracy of model after classifier transport: 89.22
2024-05-09 03:48:57,170 [trainer.py] => MBTC_VIT: {'total': 89.22, '00-01': 53.33, '02-03': 91.5, '04-05': 92.12, 'old': 84.49, 'new': 92.12}
2024-05-09 03:48:57,170 [trainer.py] => NME: {'total': 50.0, '00-01': 50.0, '02-03': 50.0, '04-05': 50.0, 'old': 50.0, 'new': 50.0}
2024-05-09 03:48:57,170 [trainer.py] => MBTC_VIT top1 curve: [54.44, 82.86, 89.22]
2024-05-09 03:48:57,170 [trainer.py] => NME top1 curve: [50.0, 50.0, 50.0]
2024-05-09 03:48:57,170 [trainer.py] => Average NME top1: 50.0
2024-05-09 03:48:57,171 [trainer.py] => Average top1: 75.50666666666667
2024-05-09 03:48:57,171 [trainer.py] => All params: 91330793
2024-05-09 03:48:57,172 [trainer.py] => Trainable params: 91330793
2024-05-09 03:48:57,172 [mbtc.py] => Learning on 6-8
2024-05-09 03:48:57,175 [vit_inc.py] => Initialize the new class nodes with the old class nodes of the previous task.
2024-05-09 03:50:23,343 [mbtc.py] => Task 3, Epoch 1/15 => Loss 0.690
2024-05-09 03:50:23,343 [mbtc.py] => {'Train loss': 0.6904959666485689}
2024-05-09 03:51:10,312 [mbtc.py] => Task 3, Epoch 2/15 => Loss 0.669
2024-05-09 03:51:10,312 [mbtc.py] => {'Train loss': 0.6688202668209465}
2024-05-09 03:51:47,954 [mbtc.py] => Task 3, Epoch 3/15 => Loss 0.620
2024-05-09 03:51:47,955 [mbtc.py] => {'Train loss': 0.6199400449285701}
2024-05-09 03:52:25,428 [mbtc.py] => Task 3, Epoch 4/15 => Loss 0.562
2024-05-09 03:52:25,428 [mbtc.py] => {'Train loss': 0.5622124611114969}
2024-05-09 03:53:20,719 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:53:35,842 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:53:35,843 [mbtc.py] => {'Train acc': 78.51, 'Test acc': 66.63}
2024-05-09 03:53:35,843 [mbtc.py] => Task 3, Epoch 5/15 => Loss 0.498, Train_accy 78.510, Test_accy 66.630
2024-05-09 03:53:35,843 [mbtc.py] => {'Train loss': 0.49785987880765176}
2024-05-09 03:54:31,080 [mbtc.py] => Task 3, Epoch 6/15 => Loss 0.510
2024-05-09 03:54:31,080 [mbtc.py] => {'Train loss': 0.5096417701974207}
2024-05-09 03:55:25,130 [mbtc.py] => Task 3, Epoch 7/15 => Loss 0.429
2024-05-09 03:55:25,130 [mbtc.py] => {'Train loss': 0.4290819514770897}
2024-05-09 03:56:16,193 [mbtc.py] => Task 3, Epoch 8/15 => Loss 0.383
2024-05-09 03:56:16,193 [mbtc.py] => {'Train loss': 0.3826734770317467}
2024-05-09 03:57:11,364 [mbtc.py] => Task 3, Epoch 9/15 => Loss 0.350
2024-05-09 03:57:11,364 [mbtc.py] => {'Train loss': 0.34980808776252126}
2024-05-09 03:58:24,982 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:58:44,688 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 03:58:44,689 [mbtc.py] => {'Train acc': 82.41, 'Test acc': 71.1}
2024-05-09 03:58:44,689 [mbtc.py] => Task 3, Epoch 10/15 => Loss 0.319, Train_accy 82.410, Test_accy 71.100
2024-05-09 03:58:44,689 [mbtc.py] => {'Train loss': 0.3187825193210524}
2024-05-09 03:59:35,458 [mbtc.py] => Task 3, Epoch 11/15 => Loss 0.290
2024-05-09 03:59:35,458 [mbtc.py] => {'Train loss': 0.28995042796037634}
2024-05-09 04:00:30,232 [mbtc.py] => Task 3, Epoch 12/15 => Loss 0.273
2024-05-09 04:00:30,232 [mbtc.py] => {'Train loss': 0.2728169137726025}
2024-05-09 04:01:23,260 [mbtc.py] => Task 3, Epoch 13/15 => Loss 0.278
2024-05-09 04:01:23,260 [mbtc.py] => {'Train loss': 0.278288442261365}
2024-05-09 04:02:13,853 [mbtc.py] => Task 3, Epoch 14/15 => Loss 0.241
2024-05-09 04:02:13,854 [mbtc.py] => {'Train loss': 0.2405771156963037}
2024-05-09 04:03:31,053 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:03:48,409 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:03:48,409 [mbtc.py] => {'Train acc': 89.71, 'Test acc': 70.62}
2024-05-09 04:03:48,409 [mbtc.py] => Task 3, Epoch 15/15 => Loss 0.235, Train_accy 89.710, Test_accy 70.620
2024-05-09 04:03:48,410 [mbtc.py] => {'Train loss': 0.23502930238538858}
2024-05-09 04:03:48,423 [mbtc.py] => Merge scalar: 0.5
2024-05-09 04:04:08,815 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:04:08,815 [mbtc.py] => Test accuracy of model after backbone merge: 79.93
2024-05-09 04:04:50,815 [mbtc.py] => Task 3, Epoch 1/5 => Loss 0.414
2024-05-09 04:04:50,816 [mbtc.py] => {'Train loss': 0.41387757476495235}
2024-05-09 04:05:34,515 [mbtc.py] => Task 3, Epoch 2/5 => Loss 0.391
2024-05-09 04:05:34,516 [mbtc.py] => {'Train loss': 0.3909317467893873}
2024-05-09 04:06:17,874 [mbtc.py] => Task 3, Epoch 3/5 => Loss 0.385
2024-05-09 04:06:17,874 [mbtc.py] => {'Train loss': 0.3845715942431469}
2024-05-09 04:07:01,603 [mbtc.py] => Task 3, Epoch 4/5 => Loss 0.371
2024-05-09 04:07:01,604 [mbtc.py] => {'Train loss': 0.3708112829801988}
2024-05-09 04:08:18,993 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:08:36,044 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:08:36,044 [mbtc.py] => {'Train acc': 78.83, 'Test acc': 79.66}
2024-05-09 04:08:36,044 [mbtc.py] => Task 3, Epoch 5/5 => Loss 0.379, Train_accy 78.830, Test_accy 79.660
2024-05-09 04:08:36,044 [mbtc.py] => {'Train loss': 0.3794407449206527}
2024-05-09 04:08:54,601 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:08:54,602 [mbtc.py] => Test accuracy of model after retraining: 79.66
2024-05-09 04:08:54,626 [mbtc.py] => The OT cost: 0.00000
2024-05-09 04:08:54,626 [mbtc.py] => Head merge ratio: 0.5
2024-05-09 04:08:54,628 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-09 04:08:54,720 [mbtc.py] => The OT cost: 47.71650
2024-05-09 04:08:54,721 [mbtc.py] => Head merge ratio: 0.5
2024-05-09 04:08:54,721 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-09 04:08:54,727 [mbtc.py] => The OT cost: 66.94960
2024-05-09 04:08:54,727 [mbtc.py] => Head merge ratio: 0.5
2024-05-09 04:08:54,727 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-09 04:09:16,620 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:09:16,621 [mbtc.py] => Test accuracy of model after classifier transport: 80.08
2024-05-09 04:10:00,569 [trainer.py] => MBTC_VIT: {'total': 80.08, '00-01': 53.33, '02-03': 80.5, '04-05': 93.75, '06-07': 75.86, 'old': 86.82, 'new': 75.86}
2024-05-09 04:10:00,570 [trainer.py] => NME: {'total': 49.63, '00-01': 50.0, '02-03': 50.0, '04-05': 50.0, '06-07': 49.39, 'old': 50.0, 'new': 49.39}
2024-05-09 04:10:00,570 [trainer.py] => MBTC_VIT top1 curve: [54.44, 82.86, 89.22, 80.08]
2024-05-09 04:10:00,570 [trainer.py] => NME top1 curve: [50.0, 50.0, 50.0, 49.63]
2024-05-09 04:10:00,570 [trainer.py] => Average NME top1: 49.9075
2024-05-09 04:10:00,570 [trainer.py] => Average top1: 76.65
2024-05-09 04:10:00,571 [trainer.py] => All params: 91332329
2024-05-09 04:10:00,571 [trainer.py] => Trainable params: 91332329
2024-05-09 04:10:00,571 [mbtc.py] => Learning on 8-10
2024-05-09 04:10:00,573 [vit_inc.py] => Initialize the new class nodes with the old class nodes of the previous task.
2024-05-09 04:11:19,091 [mbtc.py] => Task 4, Epoch 1/15 => Loss 0.643
2024-05-09 04:11:19,091 [mbtc.py] => {'Train loss': 0.6426076052036691}
2024-05-09 04:12:13,064 [mbtc.py] => Task 4, Epoch 2/15 => Loss 0.335
2024-05-09 04:12:13,064 [mbtc.py] => {'Train loss': 0.33517567432941275}
2024-05-09 04:13:01,285 [mbtc.py] => Task 4, Epoch 3/15 => Loss 0.106
2024-05-09 04:13:01,286 [mbtc.py] => {'Train loss': 0.10597703590037975}
2024-05-09 04:13:55,261 [mbtc.py] => Task 4, Epoch 4/15 => Loss 0.052
2024-05-09 04:13:55,261 [mbtc.py] => {'Train loss': 0.051714186853867895}
2024-05-09 04:15:06,598 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:15:31,720 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:15:31,721 [mbtc.py] => {'Train acc': 99.17, 'Test acc': 71.55}
2024-05-09 04:15:31,721 [mbtc.py] => Task 4, Epoch 5/15 => Loss 0.035, Train_accy 99.170, Test_accy 71.550
2024-05-09 04:15:31,721 [mbtc.py] => {'Train loss': 0.034799204822233386}
2024-05-09 04:16:20,135 [mbtc.py] => Task 4, Epoch 6/15 => Loss 0.052
2024-05-09 04:16:20,135 [mbtc.py] => {'Train loss': 0.05243470535633412}
2024-05-09 04:17:02,835 [mbtc.py] => Task 4, Epoch 7/15 => Loss 0.032
2024-05-09 04:17:02,835 [mbtc.py] => {'Train loss': 0.031514047981893764}
2024-05-09 04:17:44,144 [mbtc.py] => Task 4, Epoch 8/15 => Loss 0.026
2024-05-09 04:17:44,144 [mbtc.py] => {'Train loss': 0.02607309035560552}
2024-05-09 04:18:26,626 [mbtc.py] => Task 4, Epoch 9/15 => Loss 0.032
2024-05-09 04:18:26,627 [mbtc.py] => {'Train loss': 0.032463808395364814}
2024-05-09 04:19:29,542 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:19:54,473 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:19:54,474 [mbtc.py] => {'Train acc': 99.88, 'Test acc': 71.23}
2024-05-09 04:19:54,474 [mbtc.py] => Task 4, Epoch 10/15 => Loss 0.010, Train_accy 99.880, Test_accy 71.230
2024-05-09 04:19:54,474 [mbtc.py] => {'Train loss': 0.010499018348476037}
2024-05-09 04:20:45,500 [mbtc.py] => Task 4, Epoch 11/15 => Loss 0.010
2024-05-09 04:20:45,500 [mbtc.py] => {'Train loss': 0.010329253530684621}
2024-05-09 04:21:34,981 [mbtc.py] => Task 4, Epoch 12/15 => Loss 0.014
2024-05-09 04:21:34,981 [mbtc.py] => {'Train loss': 0.014429964298540925}
2024-05-09 04:22:28,638 [mbtc.py] => Task 4, Epoch 13/15 => Loss 0.013
2024-05-09 04:22:28,639 [mbtc.py] => {'Train loss': 0.013163308097802579}
2024-05-09 04:23:22,364 [mbtc.py] => Task 4, Epoch 14/15 => Loss 0.025
2024-05-09 04:23:22,364 [mbtc.py] => {'Train loss': 0.02502886004785591}
2024-05-09 04:24:33,117 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:24:58,252 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:24:58,253 [mbtc.py] => {'Train acc': 99.85, 'Test acc': 71.14}
2024-05-09 04:24:58,253 [mbtc.py] => Task 4, Epoch 15/15 => Loss 0.014, Train_accy 99.850, Test_accy 71.140
2024-05-09 04:24:58,253 [mbtc.py] => {'Train loss': 0.013875155494191703}
2024-05-09 04:24:58,267 [mbtc.py] => Merge scalar: 0.5
2024-05-09 04:25:25,518 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:25:25,518 [mbtc.py] => Test accuracy of model after backbone merge: 85.67
2024-05-09 04:26:18,610 [mbtc.py] => Task 4, Epoch 1/5 => Loss 0.051
2024-05-09 04:26:18,611 [mbtc.py] => {'Train loss': 0.05109081128017699}
2024-05-09 04:27:13,002 [mbtc.py] => Task 4, Epoch 2/5 => Loss 0.043
2024-05-09 04:27:13,002 [mbtc.py] => {'Train loss': 0.042986085004311926}
2024-05-09 04:28:02,584 [mbtc.py] => Task 4, Epoch 3/5 => Loss 0.043
2024-05-09 04:28:02,584 [mbtc.py] => {'Train loss': 0.04306877218186855}
2024-05-09 04:28:53,362 [mbtc.py] => Task 4, Epoch 4/5 => Loss 0.041
2024-05-09 04:28:53,363 [mbtc.py] => {'Train loss': 0.040917563351227884}
2024-05-09 04:29:56,068 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:30:16,739 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:30:16,740 [mbtc.py] => {'Train acc': 97.98, 'Test acc': 85.47}
2024-05-09 04:30:16,740 [mbtc.py] => Task 4, Epoch 5/5 => Loss 0.042, Train_accy 97.980, Test_accy 85.470
2024-05-09 04:30:16,740 [mbtc.py] => {'Train loss': 0.04153362449575612}
2024-05-09 04:30:38,885 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:30:38,885 [mbtc.py] => Test accuracy of model after retraining: 85.47
2024-05-09 04:30:39,070 [mbtc.py] => The OT cost: 30.89449
2024-05-09 04:30:39,070 [mbtc.py] => Head merge ratio: 0.5
2024-05-09 04:30:39,070 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-09 04:30:39,077 [mbtc.py] => The OT cost: 53.19462
2024-05-09 04:30:39,077 [mbtc.py] => Head merge ratio: 0.5
2024-05-09 04:30:39,078 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-09 04:30:39,699 [mbtc.py] => The OT cost: 26.93334
2024-05-09 04:30:39,699 [mbtc.py] => Head merge ratio: 0.5
2024-05-09 04:30:39,699 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-09 04:30:39,703 [mbtc.py] => The OT cost: 64.94289
2024-05-09 04:30:39,704 [mbtc.py] => Head merge ratio: 0.5
2024-05-09 04:30:39,704 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-09 04:31:08,315 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-09 04:31:08,316 [mbtc.py] => Test accuracy of model after classifier transport: 84.98
2024-05-09 04:32:05,876 [trainer.py] => MBTC_VIT: {'total': 84.98, '00-01': 53.33, '02-03': 73.75, '04-05': 94.88, '06-07': 72.37, '08-09': 97.7, 'old': 77.39, 'new': 97.7}
2024-05-09 04:32:05,877 [trainer.py] => NME: {'total': 49.77, '00-01': 50.0, '02-03': 50.0, '04-05': 50.0, '06-07': 49.39, '08-09': 50.0, 'old': 49.63, 'new': 50.0}
2024-05-09 04:32:05,877 [trainer.py] => MBTC_VIT top1 curve: [54.44, 82.86, 89.22, 80.08, 84.98]
2024-05-09 04:32:05,877 [trainer.py] => NME top1 curve: [50.0, 50.0, 50.0, 49.63, 49.77]
2024-05-09 04:32:05,877 [trainer.py] => Average NME top1: 49.88
2024-05-09 04:32:05,877 [trainer.py] => Average top1: 78.316
2024-05-09 04:32:05,877 [trainer.py] => Accuracy Matrix:
2024-05-09 04:32:05,877 [trainer.py] => [54.44  0.    0.    0.    0.  ]
2024-05-09 04:32:05,878 [trainer.py] => [56.67 88.75  0.    0.    0.  ]
2024-05-09 04:32:05,878 [trainer.py] => [53.33 91.5  92.12  0.    0.  ]
2024-05-09 04:32:05,878 [trainer.py] => [53.33 80.5  93.75 75.86  0.  ]
2024-05-09 04:32:05,879 [trainer.py] => [53.33 73.75 94.88 72.37 97.7 ]
2024-05-09 04:32:05,879 [trainer.py] => Forgetting (after last task): 6.145
2024-05-09 04:32:05,879 [trainer.py] => NME Accuracy Matrix:
2024-05-09 04:32:05,879 [trainer.py] => [50.  0.  0.  0.  0.]
2024-05-09 04:32:05,879 [trainer.py] => [50. 50.  0.  0.  0.]
2024-05-09 04:32:05,879 [trainer.py] => [50. 50. 50.  0.  0.]
2024-05-09 04:32:05,880 [trainer.py] => [50.   50.   50.   49.39  0.  ]
2024-05-09 04:32:05,880 [trainer.py] => [50.   50.   50.   49.39 50.  ]
2024-05-09 04:32:05,880 [trainer.py] => NME Forgetting (after last task): 0.0
