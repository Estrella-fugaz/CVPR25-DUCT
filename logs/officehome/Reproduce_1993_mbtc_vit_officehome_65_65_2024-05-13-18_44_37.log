2024-05-13 18:44:37,876 [trainer.py] => prefix: Reproduce
2024-05-13 18:44:37,876 [trainer.py] => dataset: officehome
2024-05-13 18:44:37,876 [trainer.py] => memory_size: 0
2024-05-13 18:44:37,877 [trainer.py] => memory_per_class: 0
2024-05-13 18:44:37,877 [trainer.py] => fixed_memory: True
2024-05-13 18:44:37,877 [trainer.py] => shuffle: False
2024-05-13 18:44:37,877 [trainer.py] => init_cls: 65
2024-05-13 18:44:37,877 [trainer.py] => increment: 65
2024-05-13 18:44:37,877 [trainer.py] => total_sessions: 4
2024-05-13 18:44:37,877 [trainer.py] => model_name: duct
2024-05-13 18:44:37,877 [trainer.py] => net_type: vit
2024-05-13 18:44:37,877 [trainer.py] => embd_dim: 768
2024-05-13 18:44:37,877 [trainer.py] => seed: 1993
2024-05-13 18:44:37,877 [trainer.py] => EPSILON: 1e-08
2024-05-13 18:44:37,877 [trainer.py] => ot_reg: 0.1
2024-05-13 18:44:37,877 [trainer.py] => lr_re: 0.001
2024-05-13 18:44:37,877 [trainer.py] => epc_re: 5
2024-05-13 18:44:37,877 [trainer.py] => bcb_lr_scale: 0.01
2024-05-13 18:44:37,877 [trainer.py] => ca_epochs: 5
2024-05-13 18:44:37,877 [trainer.py] => epochs: 15
2024-05-13 18:44:37,877 [trainer.py] => lrate: 0.1
2024-05-13 18:44:37,877 [trainer.py] => milestones: [60, 100, 140]
2024-05-13 18:44:37,877 [trainer.py] => lrate_decay: 0.1
2024-05-13 18:44:37,877 [trainer.py] => weight_decay: 0.0005
2024-05-13 18:44:37,877 [trainer.py] => batch_size: 128
2024-05-13 18:44:37,877 [trainer.py] => num_workers: 16
2024-05-13 18:44:37,877 [trainer.py] => merge_scalar: 0.25
2024-05-13 18:44:37,877 [trainer.py] => head_merge_ratio: 0.25
2024-05-13 18:44:37,877 [trainer.py] => logfilename: logs/Reproduce_1993_mbtc_vit_officehome_65_65_2024-05-13-18:44:37
2024-05-13 18:44:37,878 [data.py] => Learning sequence of domains: ['Art', 'Clipart', 'Product', 'Real_World']
2024-05-13 18:44:37,922 [data_manager.py] => class order: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259]
2024-05-13 18:44:38,002 [vit_inc.py] => You are now using `vit_base_patch16_224` as backbone.
2024-05-13 18:44:39,421 [_builder.py] => Loading pretrained weights from url (https://storage.googleapis.com/vit_models/augreg/B_16-i21k-300ep-lr_0.001-aug_medium1-wd_0.1-do_0.0-sd_0.0--imagenet2012-steps_20k-lr_0.01-res_224.npz)
2024-05-13 18:44:41,894 [trainer.py] => All params: 91326184
2024-05-13 18:44:41,895 [trainer.py] => Trainable params: 91326184
2024-05-13 18:44:41,895 [mbtc.py] => Learning on 0-65
2024-05-13 18:45:50,796 [mbtc.py] => Initial epochs: 15
2024-05-13 18:46:02,352 [mbtc.py] => Task 0, Epoch 1/15 => Loss 4.165
2024-05-13 18:46:02,353 [mbtc.py] => {'Train loss': 4.165349211011614}
2024-05-13 18:46:09,975 [mbtc.py] => Task 0, Epoch 2/15 => Loss 4.112
2024-05-13 18:46:09,975 [mbtc.py] => {'Train loss': 4.1124175276075094}
2024-05-13 18:46:17,631 [mbtc.py] => Task 0, Epoch 3/15 => Loss 4.012
2024-05-13 18:46:17,631 [mbtc.py] => {'Train loss': 4.012362650462559}
2024-05-13 18:46:24,918 [mbtc.py] => Task 0, Epoch 4/15 => Loss 3.810
2024-05-13 18:46:24,918 [mbtc.py] => {'Train loss': 3.8098330668040683}
2024-05-13 18:46:37,879 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:46:42,007 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:46:42,007 [mbtc.py] => {'Train acc': 57.24, 'Test acc': 53.77}
2024-05-13 18:46:42,007 [mbtc.py] => Task 0, Epoch 5/15 => Loss 3.408, Train_accy 57.240, Test_accy 53.770
2024-05-13 18:46:42,007 [mbtc.py] => {'Train loss': 3.4076106548309326}
2024-05-13 18:46:49,451 [mbtc.py] => Task 0, Epoch 6/15 => Loss 2.170
2024-05-13 18:46:49,452 [mbtc.py] => {'Train loss': 2.169788088117327}
2024-05-13 18:46:56,616 [mbtc.py] => Task 0, Epoch 7/15 => Loss 0.957
2024-05-13 18:46:56,616 [mbtc.py] => {'Train loss': 0.9568023937089103}
2024-05-13 18:47:03,825 [mbtc.py] => Task 0, Epoch 8/15 => Loss 0.609
2024-05-13 18:47:03,826 [mbtc.py] => {'Train loss': 0.6088175369160516}
2024-05-13 18:47:10,842 [mbtc.py] => Task 0, Epoch 9/15 => Loss 0.501
2024-05-13 18:47:10,843 [mbtc.py] => {'Train loss': 0.5009718047721046}
2024-05-13 18:47:23,855 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:47:28,075 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:47:28,075 [mbtc.py] => {'Train acc': 90.46, 'Test acc': 87.11}
2024-05-13 18:47:28,076 [mbtc.py] => Task 0, Epoch 10/15 => Loss 0.449, Train_accy 90.460, Test_accy 87.110
2024-05-13 18:47:28,076 [mbtc.py] => {'Train loss': 0.448753895504134}
2024-05-13 18:47:34,925 [mbtc.py] => Task 0, Epoch 11/15 => Loss 0.395
2024-05-13 18:47:34,926 [mbtc.py] => {'Train loss': 0.3952218379293169}
2024-05-13 18:47:42,327 [mbtc.py] => Task 0, Epoch 12/15 => Loss 0.337
2024-05-13 18:47:42,327 [mbtc.py] => {'Train loss': 0.3373766147664615}
2024-05-13 18:47:49,599 [mbtc.py] => Task 0, Epoch 13/15 => Loss 0.306
2024-05-13 18:47:49,600 [mbtc.py] => {'Train loss': 0.30566044045346125}
2024-05-13 18:47:56,809 [mbtc.py] => Task 0, Epoch 14/15 => Loss 0.290
2024-05-13 18:47:56,809 [mbtc.py] => {'Train loss': 0.2895422780088016}
2024-05-13 18:48:09,619 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:48:14,005 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:48:14,005 [mbtc.py] => {'Train acc': 94.41, 'Test acc': 86.97}
2024-05-13 18:48:14,005 [mbtc.py] => Task 0, Epoch 15/15 => Loss 0.278, Train_accy 94.410, Test_accy 86.970
2024-05-13 18:48:14,005 [mbtc.py] => {'Train loss': 0.27767332430396763}
2024-05-13 18:48:14,020 [mbtc.py] => Merge scalar: 0.25
2024-05-13 18:48:19,011 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:48:19,012 [mbtc.py] => Test accuracy of model after backbone merge: 83.26
2024-05-13 18:48:26,350 [mbtc.py] => Task 0, Epoch 1/5 => Loss 0.577
2024-05-13 18:48:26,350 [mbtc.py] => {'Train loss': 0.5773663627249854}
2024-05-13 18:48:34,029 [mbtc.py] => Task 0, Epoch 2/5 => Loss 0.580
2024-05-13 18:48:34,030 [mbtc.py] => {'Train loss': 0.5802432064499173}
2024-05-13 18:48:41,332 [mbtc.py] => Task 0, Epoch 3/5 => Loss 0.558
2024-05-13 18:48:41,333 [mbtc.py] => {'Train loss': 0.5580643841198513}
2024-05-13 18:48:48,636 [mbtc.py] => Task 0, Epoch 4/5 => Loss 0.538
2024-05-13 18:48:48,636 [mbtc.py] => {'Train loss': 0.5384413727692196}
2024-05-13 18:49:00,623 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:49:04,896 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:49:04,897 [mbtc.py] => {'Train acc': 91.7, 'Test acc': 84.77}
2024-05-13 18:49:04,897 [mbtc.py] => Task 0, Epoch 5/5 => Loss 0.564, Train_accy 91.700, Test_accy 84.770
2024-05-13 18:49:04,897 [mbtc.py] => {'Train loss': 0.5640375486442021}
2024-05-13 18:49:09,285 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:49:09,286 [mbtc.py] => Test accuracy of model after retraining: 84.77
2024-05-13 18:49:19,384 [trainer.py] => MBTC_VIT: {'total': 84.77, '00-64': 84.77, 'old': 0, 'new': 84.77}
2024-05-13 18:49:19,385 [trainer.py] => NME: {'total': 1.23, '00-64': 1.23, 'old': 0, 'new': 1.23}
2024-05-13 18:49:19,385 [trainer.py] => MBTC_VIT top1 curve: [84.77]
2024-05-13 18:49:19,385 [trainer.py] => NME top1 curve: [1.23]
2024-05-13 18:49:19,385 [trainer.py] => Average NME top1: 1.23
2024-05-13 18:49:19,385 [trainer.py] => Average top1: 84.77
2024-05-13 18:49:19,386 [trainer.py] => All params: 91376105
2024-05-13 18:49:19,386 [trainer.py] => Trainable params: 91376105
2024-05-13 18:49:19,386 [mbtc.py] => Learning on 65-130
2024-05-13 18:50:38,384 [mbtc.py] => Task 1, Epoch 1/15 => Loss 4.158
2024-05-13 18:50:38,384 [mbtc.py] => {'Train loss': 4.157917698224385}
2024-05-13 18:50:48,008 [mbtc.py] => Task 1, Epoch 2/15 => Loss 4.086
2024-05-13 18:50:48,009 [mbtc.py] => {'Train loss': 4.086320141951243}
2024-05-13 18:50:57,141 [mbtc.py] => Task 1, Epoch 3/15 => Loss 3.913
2024-05-13 18:50:57,141 [mbtc.py] => {'Train loss': 3.9125710229078927}
2024-05-13 18:51:06,550 [mbtc.py] => Task 1, Epoch 4/15 => Loss 3.489
2024-05-13 18:51:06,550 [mbtc.py] => {'Train loss': 3.4889482458432517}
2024-05-13 18:51:22,057 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:51:28,203 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:51:28,203 [mbtc.py] => {'Train acc': 60.69, 'Test acc': 71.31}
2024-05-13 18:51:28,204 [mbtc.py] => Task 1, Epoch 5/15 => Loss 2.701, Train_accy 60.690, Test_accy 71.310
2024-05-13 18:51:28,204 [mbtc.py] => {'Train loss': 2.7008937199910483}
2024-05-13 18:51:37,510 [mbtc.py] => Task 1, Epoch 6/15 => Loss 1.585
2024-05-13 18:51:37,511 [mbtc.py] => {'Train loss': 1.5848696380853653}
2024-05-13 18:51:47,010 [mbtc.py] => Task 1, Epoch 7/15 => Loss 1.073
2024-05-13 18:51:47,011 [mbtc.py] => {'Train loss': 1.0734332352876663}
2024-05-13 18:51:56,304 [mbtc.py] => Task 1, Epoch 8/15 => Loss 0.931
2024-05-13 18:51:56,304 [mbtc.py] => {'Train loss': 0.9306545630097389}
2024-05-13 18:52:05,754 [mbtc.py] => Task 1, Epoch 9/15 => Loss 0.764
2024-05-13 18:52:05,754 [mbtc.py] => {'Train loss': 0.7644471873839697}
2024-05-13 18:52:20,997 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:52:27,011 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:52:27,011 [mbtc.py] => {'Train acc': 82.55, 'Test acc': 81.8}
2024-05-13 18:52:27,011 [mbtc.py] => Task 1, Epoch 10/15 => Loss 0.712, Train_accy 82.550, Test_accy 81.800
2024-05-13 18:52:27,011 [mbtc.py] => {'Train loss': 0.712289959192276}
2024-05-13 18:52:36,256 [mbtc.py] => Task 1, Epoch 11/15 => Loss 0.640
2024-05-13 18:52:36,256 [mbtc.py] => {'Train loss': 0.6396016900738081}
2024-05-13 18:52:45,530 [mbtc.py] => Task 1, Epoch 12/15 => Loss 0.613
2024-05-13 18:52:45,530 [mbtc.py] => {'Train loss': 0.6126509693761667}
2024-05-13 18:52:55,318 [mbtc.py] => Task 1, Epoch 13/15 => Loss 0.582
2024-05-13 18:52:55,318 [mbtc.py] => {'Train loss': 0.5819962012271086}
2024-05-13 18:53:05,007 [mbtc.py] => Task 1, Epoch 14/15 => Loss 0.556
2024-05-13 18:53:05,007 [mbtc.py] => {'Train loss': 0.556415494531393}
2024-05-13 18:53:19,924 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:53:25,362 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:53:25,363 [mbtc.py] => {'Train acc': 87.07, 'Test acc': 83.57}
2024-05-13 18:53:25,369 [mbtc.py] => Task 1, Epoch 15/15 => Loss 0.501, Train_accy 87.070, Test_accy 83.570
2024-05-13 18:53:25,369 [mbtc.py] => {'Train loss': 0.5014557540416718}
2024-05-13 18:53:25,383 [mbtc.py] => Merge scalar: 0.25
2024-05-13 18:53:32,397 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:53:32,398 [mbtc.py] => Test accuracy of model after backbone merge: 77.05
2024-05-13 18:53:41,135 [mbtc.py] => Task 1, Epoch 1/5 => Loss 0.940
2024-05-13 18:53:41,135 [mbtc.py] => {'Train loss': 0.9400407994786898}
2024-05-13 18:53:49,871 [mbtc.py] => Task 1, Epoch 2/5 => Loss 0.904
2024-05-13 18:53:49,871 [mbtc.py] => {'Train loss': 0.9042735199133555}
2024-05-13 18:53:58,828 [mbtc.py] => Task 1, Epoch 3/5 => Loss 0.843
2024-05-13 18:53:58,828 [mbtc.py] => {'Train loss': 0.8434873819351196}
2024-05-13 18:54:08,419 [mbtc.py] => Task 1, Epoch 4/5 => Loss 0.813
2024-05-13 18:54:08,419 [mbtc.py] => {'Train loss': 0.8126202449202538}
2024-05-13 18:54:23,153 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:54:29,105 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:54:29,105 [mbtc.py] => {'Train acc': 75.74, 'Test acc': 78.32}
2024-05-13 18:54:29,105 [mbtc.py] => Task 1, Epoch 5/5 => Loss 0.828, Train_accy 75.740, Test_accy 78.320
2024-05-13 18:54:29,105 [mbtc.py] => {'Train loss': 0.827861987054348}
2024-05-13 18:54:34,843 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:54:34,844 [mbtc.py] => Test accuracy of model after retraining: 78.32
2024-05-13 18:54:35,126 [mbtc.py] => The OT cost: 42.05412
2024-05-13 18:54:35,126 [mbtc.py] => Head merge ratio: 0.25
2024-05-13 18:54:35,126 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-13 18:54:42,011 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:54:42,012 [mbtc.py] => Test accuracy of model after classifier transport: 78.37
2024-05-13 18:54:54,588 [trainer.py] => MBTC_VIT: {'total': 78.37, '00-64': 87.79, '65-129': 73.13, 'old': 87.79, 'new': 73.13}
2024-05-13 18:54:54,588 [trainer.py] => NME: {'total': 1.08, '00-64': 1.23, '65-129': 0.99, 'old': 1.23, 'new': 0.99}
2024-05-13 18:54:54,588 [trainer.py] => MBTC_VIT top1 curve: [84.77, 78.37]
2024-05-13 18:54:54,588 [trainer.py] => NME top1 curve: [1.23, 1.08]
2024-05-13 18:54:54,588 [trainer.py] => Average NME top1: 1.155
2024-05-13 18:54:54,588 [trainer.py] => Average top1: 81.57
2024-05-13 18:54:54,589 [trainer.py] => All params: 91426025
2024-05-13 18:54:54,589 [trainer.py] => Trainable params: 91426025
2024-05-13 18:54:54,589 [mbtc.py] => Learning on 130-195
2024-05-13 18:56:17,890 [mbtc.py] => Task 2, Epoch 1/15 => Loss 4.146
2024-05-13 18:56:17,890 [mbtc.py] => {'Train loss': 4.146367568969726}
2024-05-13 18:56:27,333 [mbtc.py] => Task 2, Epoch 2/15 => Loss 3.963
2024-05-13 18:56:27,333 [mbtc.py] => {'Train loss': 3.9631081581115724}
2024-05-13 18:56:37,041 [mbtc.py] => Task 2, Epoch 3/15 => Loss 3.265
2024-05-13 18:56:37,041 [mbtc.py] => {'Train loss': 3.26501519203186}
2024-05-13 18:56:46,810 [mbtc.py] => Task 2, Epoch 4/15 => Loss 1.712
2024-05-13 18:56:46,810 [mbtc.py] => {'Train loss': 1.7116821193695069}
2024-05-13 18:57:01,595 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:57:09,100 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:57:09,101 [mbtc.py] => {'Train acc': 90.51, 'Test acc': 78.34}
2024-05-13 18:57:09,101 [mbtc.py] => Task 2, Epoch 5/15 => Loss 0.751, Train_accy 90.510, Test_accy 78.340
2024-05-13 18:57:09,101 [mbtc.py] => {'Train loss': 0.7507863354682922}
2024-05-13 18:57:19,119 [mbtc.py] => Task 2, Epoch 6/15 => Loss 0.443
2024-05-13 18:57:19,119 [mbtc.py] => {'Train loss': 0.4434036475419998}
2024-05-13 18:57:29,398 [mbtc.py] => Task 2, Epoch 7/15 => Loss 0.333
2024-05-13 18:57:29,399 [mbtc.py] => {'Train loss': 0.33257068037986753}
2024-05-13 18:57:39,950 [mbtc.py] => Task 2, Epoch 8/15 => Loss 0.280
2024-05-13 18:57:39,950 [mbtc.py] => {'Train loss': 0.2796420079469681}
2024-05-13 18:57:50,237 [mbtc.py] => Task 2, Epoch 9/15 => Loss 0.252
2024-05-13 18:57:50,237 [mbtc.py] => {'Train loss': 0.2524849373102188}
2024-05-13 18:58:06,583 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:58:14,046 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:58:14,047 [mbtc.py] => {'Train acc': 95.24, 'Test acc': 77.81}
2024-05-13 18:58:14,047 [mbtc.py] => Task 2, Epoch 10/15 => Loss 0.220, Train_accy 95.240, Test_accy 77.810
2024-05-13 18:58:14,047 [mbtc.py] => {'Train loss': 0.21992330074310304}
2024-05-13 18:58:23,505 [mbtc.py] => Task 2, Epoch 11/15 => Loss 0.201
2024-05-13 18:58:23,505 [mbtc.py] => {'Train loss': 0.200579175055027}
2024-05-13 18:58:32,442 [mbtc.py] => Task 2, Epoch 12/15 => Loss 0.177
2024-05-13 18:58:32,442 [mbtc.py] => {'Train loss': 0.17711250960826874}
2024-05-13 18:58:41,412 [mbtc.py] => Task 2, Epoch 13/15 => Loss 0.163
2024-05-13 18:58:41,413 [mbtc.py] => {'Train loss': 0.1632320439815521}
2024-05-13 18:58:51,211 [mbtc.py] => Task 2, Epoch 14/15 => Loss 0.178
2024-05-13 18:58:51,211 [mbtc.py] => {'Train loss': 0.17763324961066246}
2024-05-13 18:59:07,047 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:59:14,371 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:59:14,372 [mbtc.py] => {'Train acc': 96.01, 'Test acc': 77.48}
2024-05-13 18:59:14,372 [mbtc.py] => Task 2, Epoch 15/15 => Loss 0.155, Train_accy 96.010, Test_accy 77.480
2024-05-13 18:59:14,372 [mbtc.py] => {'Train loss': 0.1547095723450184}
2024-05-13 18:59:14,386 [mbtc.py] => Merge scalar: 0.25
2024-05-13 18:59:22,566 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 18:59:22,567 [mbtc.py] => Test accuracy of model after backbone merge: 85.26
2024-05-13 18:59:31,676 [mbtc.py] => Task 2, Epoch 1/5 => Loss 0.247
2024-05-13 18:59:31,677 [mbtc.py] => {'Train loss': 0.24674338221549988}
2024-05-13 18:59:41,349 [mbtc.py] => Task 2, Epoch 2/5 => Loss 0.246
2024-05-13 18:59:41,349 [mbtc.py] => {'Train loss': 0.24596453309059144}
2024-05-13 18:59:51,096 [mbtc.py] => Task 2, Epoch 3/5 => Loss 0.238
2024-05-13 18:59:51,097 [mbtc.py] => {'Train loss': 0.23774501264095307}
2024-05-13 19:00:01,142 [mbtc.py] => Task 2, Epoch 4/5 => Loss 0.234
2024-05-13 19:00:01,142 [mbtc.py] => {'Train loss': 0.23357677698135376}
2024-05-13 19:00:17,734 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:00:25,536 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:00:25,536 [mbtc.py] => {'Train acc': 93.53, 'Test acc': 85.17}
2024-05-13 19:00:25,537 [mbtc.py] => Task 2, Epoch 5/5 => Loss 0.219, Train_accy 93.530, Test_accy 85.170
2024-05-13 19:00:25,537 [mbtc.py] => {'Train loss': 0.21871945321559905}
2024-05-13 19:00:32,946 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:00:32,947 [mbtc.py] => Test accuracy of model after retraining: 85.17
2024-05-13 19:00:33,229 [mbtc.py] => The OT cost: 39.63602
2024-05-13 19:00:33,229 [mbtc.py] => Head merge ratio: 0.25
2024-05-13 19:00:33,229 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-13 19:00:33,508 [mbtc.py] => The OT cost: 43.72858
2024-05-13 19:00:33,508 [mbtc.py] => Head merge ratio: 0.25
2024-05-13 19:00:33,508 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-13 19:00:42,262 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:00:42,263 [mbtc.py] => Test accuracy of model after classifier transport: 85.11
2024-05-13 19:00:58,996 [trainer.py] => MBTC_VIT: {'total': 85.11, '00-64': 87.11, '65-129': 75.8, '130-194': 93.17, 'old': 79.84, 'new': 93.17}
2024-05-13 19:00:58,996 [trainer.py] => NME: {'total': 1.45, '00-64': 1.23, '65-129': 0.99, '130-194': 2.03, 'old': 1.08, 'new': 2.03}
2024-05-13 19:00:58,996 [trainer.py] => MBTC_VIT top1 curve: [84.77, 78.37, 85.11]
2024-05-13 19:00:58,996 [trainer.py] => NME top1 curve: [1.23, 1.08, 1.45]
2024-05-13 19:00:58,996 [trainer.py] => Average NME top1: 1.2533333333333332
2024-05-13 19:00:58,996 [trainer.py] => Average top1: 82.75
2024-05-13 19:00:58,996 [trainer.py] => All params: 91475945
2024-05-13 19:00:58,997 [trainer.py] => Trainable params: 91475945
2024-05-13 19:00:58,997 [mbtc.py] => Learning on 195-260
2024-05-13 19:03:52,824 [mbtc.py] => Task 3, Epoch 1/15 => Loss 4.154
2024-05-13 19:03:52,825 [mbtc.py] => {'Train loss': 4.15368405977885}
2024-05-13 19:04:05,188 [mbtc.py] => Task 3, Epoch 2/15 => Loss 4.011
2024-05-13 19:04:05,188 [mbtc.py] => {'Train loss': 4.010689149300258}
2024-05-13 19:04:18,993 [mbtc.py] => Task 3, Epoch 3/15 => Loss 3.504
2024-05-13 19:04:18,993 [mbtc.py] => {'Train loss': 3.5042015512784324}
2024-05-13 19:04:31,935 [mbtc.py] => Task 3, Epoch 4/15 => Loss 2.149
2024-05-13 19:04:31,936 [mbtc.py] => {'Train loss': 2.1488558699687323}
2024-05-13 19:04:56,507 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:05:05,356 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:05:05,357 [mbtc.py] => {'Train acc': 87.9, 'Test acc': 79.82}
2024-05-13 19:05:05,357 [mbtc.py] => Task 3, Epoch 5/15 => Loss 0.923, Train_accy 87.900, Test_accy 79.820
2024-05-13 19:05:05,357 [mbtc.py] => {'Train loss': 0.9231510112682978}
2024-05-13 19:05:18,797 [mbtc.py] => Task 3, Epoch 6/15 => Loss 0.492
2024-05-13 19:05:18,797 [mbtc.py] => {'Train loss': 0.49154531086484593}
2024-05-13 19:05:32,126 [mbtc.py] => Task 3, Epoch 7/15 => Loss 0.333
2024-05-13 19:05:32,127 [mbtc.py] => {'Train loss': 0.3329837092508872}
2024-05-13 19:05:45,027 [mbtc.py] => Task 3, Epoch 8/15 => Loss 0.281
2024-05-13 19:05:45,027 [mbtc.py] => {'Train loss': 0.28092155295113724}
2024-05-13 19:05:57,650 [mbtc.py] => Task 3, Epoch 9/15 => Loss 0.276
2024-05-13 19:05:57,651 [mbtc.py] => {'Train loss': 0.27568747599919635}
2024-05-13 19:06:21,460 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:06:30,010 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:06:30,011 [mbtc.py] => {'Train acc': 94.06, 'Test acc': 80.64}
2024-05-13 19:06:30,011 [mbtc.py] => Task 3, Epoch 10/15 => Loss 0.244, Train_accy 94.060, Test_accy 80.640
2024-05-13 19:06:30,011 [mbtc.py] => {'Train loss': 0.24433144057790437}
2024-05-13 19:06:42,829 [mbtc.py] => Task 3, Epoch 11/15 => Loss 0.242
2024-05-13 19:06:42,829 [mbtc.py] => {'Train loss': 0.24162373195091882}
2024-05-13 19:06:55,746 [mbtc.py] => Task 3, Epoch 12/15 => Loss 0.207
2024-05-13 19:06:55,747 [mbtc.py] => {'Train loss': 0.20704476286967596}
2024-05-13 19:07:09,475 [mbtc.py] => Task 3, Epoch 13/15 => Loss 0.206
2024-05-13 19:07:09,475 [mbtc.py] => {'Train loss': 0.20635483538111052}
2024-05-13 19:07:24,203 [mbtc.py] => Task 3, Epoch 14/15 => Loss 0.181
2024-05-13 19:07:24,204 [mbtc.py] => {'Train loss': 0.18131466768682003}
2024-05-13 19:07:47,974 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:07:56,459 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:07:56,459 [mbtc.py] => {'Train acc': 95.11, 'Test acc': 81.71}
2024-05-13 19:07:56,459 [mbtc.py] => Task 3, Epoch 15/15 => Loss 0.184, Train_accy 95.110, Test_accy 81.710
2024-05-13 19:07:56,459 [mbtc.py] => {'Train loss': 0.18429555650800467}
2024-05-13 19:07:56,472 [mbtc.py] => Merge scalar: 0.25
2024-05-13 19:08:06,046 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:08:06,047 [mbtc.py] => Test accuracy of model after backbone merge: 86.75
2024-05-13 19:08:18,986 [mbtc.py] => Task 3, Epoch 1/5 => Loss 0.235
2024-05-13 19:08:18,986 [mbtc.py] => {'Train loss': 0.23521658405661583}
2024-05-13 19:08:32,545 [mbtc.py] => Task 3, Epoch 2/5 => Loss 0.243
2024-05-13 19:08:32,546 [mbtc.py] => {'Train loss': 0.2426085484524568}
2024-05-13 19:08:44,905 [mbtc.py] => Task 3, Epoch 3/5 => Loss 0.216
2024-05-13 19:08:44,906 [mbtc.py] => {'Train loss': 0.21601146707932153}
2024-05-13 19:08:57,591 [mbtc.py] => Task 3, Epoch 4/5 => Loss 0.212
2024-05-13 19:08:57,591 [mbtc.py] => {'Train loss': 0.212486467945079}
2024-05-13 19:09:21,170 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:09:30,353 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:09:30,353 [mbtc.py] => {'Train acc': 92.98, 'Test acc': 86.81}
2024-05-13 19:09:30,353 [mbtc.py] => Task 3, Epoch 5/5 => Loss 0.215, Train_accy 92.980, Test_accy 86.810
2024-05-13 19:09:30,353 [mbtc.py] => {'Train loss': 0.2147433857123057}
2024-05-13 19:09:39,160 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:09:39,160 [mbtc.py] => Test accuracy of model after retraining: 86.81
2024-05-13 19:09:39,436 [mbtc.py] => The OT cost: 29.70927
2024-05-13 19:09:39,436 [mbtc.py] => Head merge ratio: 0.25
2024-05-13 19:09:39,437 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-13 19:09:39,710 [mbtc.py] => The OT cost: 45.76991
2024-05-13 19:09:39,710 [mbtc.py] => Head merge ratio: 0.25
2024-05-13 19:09:39,711 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-13 19:09:39,996 [mbtc.py] => The OT cost: 31.34536
2024-05-13 19:09:39,996 [mbtc.py] => Head merge ratio: 0.25
2024-05-13 19:09:39,996 [mbtc.py] => Distance between old head weight and updated head weight: 0.0000000000
2024-05-13 19:09:50,099 [base.py] => Hint: You are using _compute_accuracy_domain().
2024-05-13 19:09:50,100 [mbtc.py] => Test accuracy of model after classifier transport: 86.79
2024-05-13 19:10:10,921 [trainer.py] => MBTC_VIT: {'total': 86.79, '00-64': 86.69, '65-129': 75.19, '130-194': 93.17, '195-259': 91.97, 'old': 84.78, 'new': 91.97}
2024-05-13 19:10:10,921 [trainer.py] => NME: {'total': 1.26, '00-64': 0.69, '65-129': 2.06, '130-194': 0.83, '195-259': 1.22, 'old': 1.28, 'new': 1.22}
2024-05-13 19:10:10,921 [trainer.py] => MBTC_VIT top1 curve: [84.77, 78.37, 85.11, 86.79]
2024-05-13 19:10:10,921 [trainer.py] => NME top1 curve: [1.23, 1.08, 1.45, 1.26]
2024-05-13 19:10:10,921 [trainer.py] => Average NME top1: 1.255
2024-05-13 19:10:10,921 [trainer.py] => Average top1: 83.76
2024-05-13 19:10:10,921 [trainer.py] => Accuracy Matrix:
2024-05-13 19:10:10,921 [trainer.py] => [84.77  0.    0.    0.  ]
2024-05-13 19:10:10,922 [trainer.py] => [87.79 73.13  0.    0.  ]
2024-05-13 19:10:10,922 [trainer.py] => [87.11 75.8  93.17  0.  ]
2024-05-13 19:10:10,922 [trainer.py] => [86.69 75.19 93.17 91.97]
2024-05-13 19:10:10,922 [trainer.py] => Forgetting (after last task): 0.5700000000000026
2024-05-13 19:10:10,922 [trainer.py] => NME Accuracy Matrix:
2024-05-13 19:10:10,922 [trainer.py] => [1.23 0.   0.   0.  ]
2024-05-13 19:10:10,922 [trainer.py] => [1.23 0.99 0.   0.  ]
2024-05-13 19:10:10,923 [trainer.py] => [1.23 0.99 2.03 0.  ]
2024-05-13 19:10:10,923 [trainer.py] => [0.69 2.06 0.83 1.22]
2024-05-13 19:10:10,923 [trainer.py] => NME Forgetting (after last task): 0.58
